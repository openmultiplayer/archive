<!DOCTYPE html>
<!-- saved from url=(0052)https://sampforum.blast.hk/showthread.php?tid=571550 -->
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Code optimisations</title>
<!-- start: headerinclude -->
<link rel="alternate" type="application/rss+xml" title="Latest Threads (RSS 2.0)" href="https://sampforum.blast.hk/syndication.php">
<link rel="alternate" type="application/atom+xml" title="Latest Threads (Atom 1.0)" href="https://sampforum.blast.hk/syndication.php?type=atom1.0">
<link rel="shortcut icon" href="https://sampforum.blast.hk/favicon.ico">

<meta name="viewport" content="width=device-width, initial-scale=1">

<script type="text/javascript" src="./Code optimisations_files/jquery.js"></script><style>undefined</style>
<script type="text/javascript" src="./Code optimisations_files/bootstrap.min.js"></script>
<script type="text/javascript" src="./Code optimisations_files/jquery.plugins.min.js"></script>
<script type="text/javascript" src="./Code optimisations_files/general.js"></script>
<script type="text/javascript" src="./Code optimisations_files/tooltip.js"></script>

<link rel="stylesheet" href="./Code optimisations_files/bootstrap.min.css">
<link href="./Code optimisations_files/css" rel="stylesheet" type="text/css">
<!-- link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" / -->
<link rel="stylesheet" href="./Code optimisations_files/fork-awesome.min.css" integrity="sha256-gsmEoJAws/Kd3CjuOQzLie5Q3yshhvmo7YNtBG7aaEY=" crossorigin="anonymous">

<link type="text/css" rel="stylesheet" href="./Code optimisations_files/global.css">
<link type="text/css" rel="stylesheet" href="./Code optimisations_files/css3.css">
<link type="text/css" rel="stylesheet" href="./Code optimisations_files/responsive.css">
<link type="text/css" rel="stylesheet" href="./Code optimisations_files/star_ratings.css">
<link type="text/css" rel="stylesheet" href="./Code optimisations_files/showthread.css">
<link type="text/css" rel="stylesheet" href="./Code optimisations_files/grey.css">




<script type="text/javascript">
jQuery(document).on('click', '.panel-heading span.clickable', function(e){
    var jQuerythis = jQuery(this);
	if(!jQuerythis.hasClass('panel-collapsed')) {
		jQuerythis.parents('.panel').find('.panel-body').slideUp();
		jQuerythis.addClass('panel-collapsed');
		jQuerythis.find('i').removeClass('glyphicon-chevron-up').addClass('glyphicon-chevron-down');
	} else {
		jQuerythis.parents('.panel').find('.panel-body').slideDown();
		jQuerythis.removeClass('panel-collapsed');
		jQuerythis.find('i').removeClass('glyphicon-chevron-down').addClass('glyphicon-chevron-up');
	}
})
</script>




<script type="text/javascript">
	lang.unknown_error = "An unknown error has occurred.";
	lang.confirm_title = "Please Confirm";
	lang.expcol_collapse = "[-]";
	lang.expcol_expand = "[+]";
	lang.select2_match = "One result is available, press enter to select it.";
	lang.select2_matches = "{1} results are available, use up and down arrow keys to navigate.";
	lang.select2_nomatches = "No matches found";
	lang.select2_inputtooshort_single = "Please enter one or more character";
	lang.select2_inputtooshort_plural = "Please enter {1} or more characters";
	lang.select2_inputtoolong_single = "Please delete one character";
	lang.select2_inputtoolong_plural = "Please delete {1} characters";
	lang.select2_selectiontoobig_single = "You can only select one item";
	lang.select2_selectiontoobig_plural = "You can only select {1} items";
	lang.select2_loadmore = "Loading more results&hellip;";
	lang.select2_searching = "Searching&hellip;";
	
	var templates = {
		modal: '<div class=\"modal\">\
	<div style=\"overflow-y: auto; max-height: 400px;\">\
		<table border=\"0\" cellspacing=\"0\" cellpadding=\"5\" class=\"tborder\">\
			<tr>\
				<td class=\"thead\"><strong>__title__</strong></td>\
			</tr>\
			<tr>\
				<td class=\"trow1\">__message__</td>\
			</tr>\
			<tr>\
				<td class=\"tfoot\">\
					<div style=\"text-align: center\" class=\"modal_buttons\">__buttons__</div>\
				</td>\
			</tr>\
		</table>\
	</div>\
</div>',
		modal_button: '<input type=\"submit\" class=\"button\" value=\"__title__\"/>&nbsp;'
	};
	
	var cookieSecureFlag = "0";
	var cookieDomain = ".sampforum.blast.hk";
	var cookiePath = "/";
	var cookiePrefix = "";
	var deleteevent_confirm = "Are you sure you want to delete this event?";
	var removeattach_confirm = "Are you sure you want to remove the selected attachment from this post?";
	var loading_text = 'Loading. <br />Please Wait&hellip;';
	var saving_changes = 'Saving changes&hellip;';
	var use_xmlhttprequest = "1";
	var my_post_key = "2220ae0a21c853e6459922e7a63ded4d";
	var rootpath = "https://sampforum.blast.hk";
	var imagepath = "https://sampforum.blast.hk/images/bootbb";
  	var yes_confirm = "Yes";
	var no_confirm = "No";
	var MyBBEditor = null;
	var spinner_image = "https://sampforum.blast.hk/images/bootbb/spinner.gif";
	var spinner = "<img src='" + spinner_image +"' alt='' />";
	var modal_zindex = 9999;
</script>

<!-- Make videos responsive - https://github.com/davatron5000/FitVids.js (additional video sites added for MyBB) -->
<script type="text/javascript" src="./Code optimisations_files/jquery.fitvids.js"></script>
<script>
	$(document).ready(function(){
		// Target the iframe parent div
		var bvc = $(".bootbb-video-container");
		//bvc.css("max-width", "800px");
		bvc.fitVids();
	});
</script>
<!-- end: headerinclude -->
<script>
<!--
	var quickdelete_confirm = "Are you sure you want to delete this post?";
	var quickrestore_confirm = "Are you sure you want to restore this post?";
	var allowEditReason = "1";
	lang.save_changes = "Save Changes";
	lang.cancel_edit = "Cancel Edit";
	lang.quick_edit_update_error = "There was an error editing your reply:";
	lang.quick_reply_post_error = "There was an error posting your reply:";
	lang.quick_delete_error = "There was an error deleting your reply:";
	lang.quick_delete_success = "The post was deleted successfully.";
	lang.quick_delete_thread_success = "The thread was deleted successfully.";
	lang.quick_restore_error = "There was an error restoring your reply:";
	lang.quick_restore_success = "The post was restored successfully.";
	lang.editreason = "Edit Reason";
// -->
</script>
<!-- jeditable (jquery) -->
<script src="./Code optimisations_files/report.js"></script>
<script src="./Code optimisations_files/jeditable.min.js"></script>
<script src="./Code optimisations_files/thread.js"></script>
<meta name="description" content="Code optimisation ContentsContents Introduction String optimisation State machines (automata) Callback hooks Interesting Macros Testingforeach Minor optimisationsIEEE numbers Rearranging Data rearrang">
<link rel="canonical" href="https://sampforum.blast.hk/showthread.php?tid=571550">
<style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><link rel="preconnect" href="https://fonts.googleapis.com/" crossorigin="true"><link rel="preconnect" href="https://fonts.gstatic.com/"><link rel="stylesheet" href="./Code optimisations_files/css2"></head>
<body>
	<!-- start: header -->
<header>
<div class="navbar navbar-default">
     <div class="container">
          <div class="navbar-header">
               <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse" aria-label="Toggle navigation">
               <span class="icon-bar"></span>
               <span class="icon-bar"></span>
               <span class="icon-bar"></span> 
               </button>
			  
			  <div class="navbar-header scaleimages">
				  <!--<a class="navbar-brand" href="https://sampforum.blast.hk">BootBB</a>-->
				  <a class="" href="https://sampforum.blast.hk/"><img src="./Code optimisations_files/logo_forum.gif"></a>
			  
			  </div>
          </div>
          <div class="collapse navbar-collapse navbar-ex1-collapse">
			  <ul class="nav navbar-nav navbar-right">
				  <!--<li id="nav-portal"><a href="https://sampforum.blast.hk/portal.php"><i class="fa fa-bell"></i> Portal</a></li>-->
               <li id="nav-forums"><a href="https://sampforum.blast.hk/index.php"><i class="fa fa-group"></i> Forum</a></li>
				<!--<li><a href="https://sampforum.blast.hk/search.php?action=getnew"><i class="fa fa-comment"></i> New Posts</a></li>
            	<li><a href="https://sampforum.blast.hk/search.php?action=getdaily"><i class="fa fa-comments"></i> Today's Posts</a></li>-->
               <li id="nav-search"><a href="https://sampforum.blast.hk/search.php"><i class="fa fa-search"></i> Search</a></li>
               <li id="nav-member"><a href="https://sampforum.blast.hk/memberlist.php"><i class="fa fa-users"></i> Members</a></li>
               <li id="nav-help"><a href="https://sampforum.blast.hk/misc.php?action=help"><i class="fa fa-life-bouy"></i> Help</a></li>
				  
<!--<li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-cubes"></i> Misc <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
			  <li id="nav-help"><a href="https://sampforum.blast.hk/misc.php?action=help"><i class="fa fa-life-bouy"></i> Help</a></li>
			  <li class="divider"></li>
			  <li id="nav-calendar"><a href="https://sampforum.blast.hk/calendar.php"><i class="fa fa-calendar"></i> Calendar</a></li>
          </ul>
</li> -->
</ul>
  
          </div>
     </div>
</div>
</header>


<div id="container">
	<a name="top" id="top"></a>
		<div id="header">
			<div id="panel">
				<div class="upper">
					<div class="container">

						<!-- start: header_welcomeblock_guest -->
<!--<span><a href="https://sampforum.blast.hk/member.php?action=login" onclick="$('#quick_login').modal({ fadeDuration: 250, keepelement: true }); return false;" class="login btn btn-danger" style="color: #fff;"><i class="fa fa-sign-in"></i> Login</a> <a href="https://sampforum.blast.hk/member.php?action=register" class="register btn btn-success" style="color: #fff;"><i class="fa fa-user-plus"></i> Register</a></span>-->

<span class="float_right hidden-xs">Hello There, Guest!</span>

<br class="clearfix">
	

				<div class="modal" id="quick_login" style="display: none;">
					<form method="post" action="https://sampforum.blast.hk/member.php">
						<input name="my_post_key" type="hidden" value="2220ae0a21c853e6459922e7a63ded4d">
						<input name="action" type="hidden" value="do_login">
						<input name="url" type="hidden" value="https://sampforum.blast.hk/showthread.php?tid=571550">
						<input name="quick_login" type="hidden" value="1">
						<table width="100%" cellspacing="0" cellpadding="0" border="0" class="tborder">
							<tbody><tr>
								<td class="thead" colspan="2"><strong>Login</strong></td>
							</tr>
							<tr>
								<td class="trow1" width="25%"><strong>Username:</strong></td>
								<td class="trow1"><input name="quick_username" id="quick_login_username" type="text" value="" class="textbox initial_focus"></td>
							</tr>
							<tr>
								<td class="trow2"><strong>Password:</strong></td>
								<td class="trow2">
									<input name="quick_password" id="quick_login_password" type="password" value="" class="textbox"> <a href="https://sampforum.blast.hk/member.php?action=lostpw" class="lost_password">Lost Password?</a>
								</td>
							</tr>
							<tr>
								<td class="trow1">&nbsp;</td>
								<td class="trow1 remember_me">
									<input name="quick_remember" id="quick_login_remember" type="checkbox" value="yes" class="checkbox" checked="checked">
									<label for="quick_login_remember">Remember me</label>
								</td>
							</tr>
							<tr>
								<td class="trow2" colspan="2">
									<div align="center"><input name="submit" type="submit" class="button" value="Login"></div>
								</td>
							</tr>
						</tbody></table>
					</form>
				</div>
				<script type="text/javascript">
					$("#quick_login input[name='url']").val($(location).attr('href'));
				</script>
<!-- end: header_welcomeblock_guest -->
					
					</div>
			</div>
			</div>
	</div>
			</div>
               
				   
                <main class="container">
				<br>
                 <!-- start: nav -->
<ol class="breadcrumb container"><!-- start: nav_bit -->
<li><a href="https://sampforum.blast.hk/index.php">SA-MP Forums Archive</a></li>
<!-- end: nav_bit --><!-- start: nav_bit -->
<li><a href="https://sampforum.blast.hk/forumdisplay.php?fid=8">SA-MP Scripting and Plugins</a></li>
<!-- end: nav_bit --><!-- start: nav_bit -->
<li><a href="https://sampforum.blast.hk/forumdisplay.php?fid=12">Scripting Help</a></li>
<!-- end: nav_bit --><!-- start: nav_bit -->
<li><a href="https://sampforum.blast.hk/forumdisplay.php?fid=84&amp;page=2">Discussion</a></li>
<!-- end: nav_bit --><!-- start: nav_sep_active -->

<!-- end: nav_sep_active --></ol>
<!-- end: nav -->
				
				
				
				
				
				
<!-- end: header -->
	
	
	<div class="float_left">
		
	</div>
	<div class="float_right">
		
	</div>
	<br class="clear">
	<div class="tborder tfixed clear">
		<div class="thead">
				<div class="float_right">
					<span class="smalltext"><a href="https://sampforum.blast.hk/showthread.php?mode=threaded&amp;tid=571550&amp;pid=3435601#pid3435601">Threaded Mode</a></span>
				</div>
				
					Code optimisations
			</div>
	</div>
<div id="posts_container">
	<div id="posts">
		<!-- start: postbit_classic -->

<a id="pid3435601"></a>
<div class="post classic " style="" id="post_3435601">
<div class="post_author scaleimages">
	<!-- start: postbit_avatar -->
<div class="postbit_avatar author_avatar"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=55934"><img src="./Code optimisations_files/55934.png" alt="" width="55" height="42"></a></div>
<!-- end: postbit_avatar -->
	<div class="author_information">
			<strong><span class="largetext"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=55934">Misiur</a></span></strong> <!-- start: postbit_offline -->
<span class="online_status status_offline" title="Offline"></span>
<!-- end: postbit_offline --><br>
			<span class="smalltext">
				High-roller<br>
				<span class="postbit_userstars"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><br></span>
				
			</span>
	</div>
	<div class="author_statistics">
		<!-- start: postbit_author_user -->
	Posts: 2,528<br>
	Threads: 124<br>
	Joined: Jul 2009
	<!-- start: postbit_reputation -->
<br>Reputation: <!-- start: postbit_reputation_formatted_link -->
<a href="https://sampforum.blast.hk/reputation.php?uid=55934"><strong class="reputation_neutral">0</strong></a>
<!-- end: postbit_reputation_formatted_link -->
<!-- end: postbit_reputation --><br>
<!-- end: postbit_author_user -->
	</div>
</div>
<div class="post_content">
	<div class="post_head">
		<!-- start: postbit_posturl -->
<div class="float_right" style="vertical-align: top">
<strong><a href="https://sampforum.blast.hk/showthread.php?tid=571550&amp;pid=3435601#pid3435601" title="Code optimisations">#1</a></strong>

</div>
<!-- end: postbit_posturl -->
		
		<h1 aria-label="Post: 1 by Misiur" style="display:inline;font-size:9px;"><!-- helps navigation for screen readers --></h1>
		<span class="post_date">19.04.2015, 16:43 <span class="post_edit" id="edited_by_3435601"></span></span>
	
	</div>
	<div class="post_body scaleimages" id="pid_3435601">
		<font size="7"><font color="green"><b><u><div align="center">Code optimisation</div></u></b></font></font><br>
<br>
<font size="5"><font color="green"><b><u>Contents</u></b></font></font><ul><li><u>Contents</u></li>
<li><u>Introduction</u></li>
<li><u>String optimisation</u></li>
<li><u>State machines (automata)</u></li>
<li><u>Callback hooks</u></li>
<li><u>Interesting Macros</u></li>
<li><u>Testing</u><ul><li><u>foreach</u></li>
</ul></li>
<li><u>Minor optimisations</u><ul><li><u>IEEE numbers</u></li>
<li><u>Rearranging</u></li>
<li><u>Data rearrangements</u></li>
<li><u>Know the language</u></li>
<li><u>Distance checks</u></li>
<li><u>Speed order</u></li>
<li><u>Know your values</u></li>
<li><u>Return values</u></li>
<li><u>Small snippets</u><ul><li><u>Equivalence</u></li>
<li><u>Empty strings</u></li>
<li><u>Copying strings</u></li>
</ul></li>
</ul></li>
<li><u>Assumptions</u><ul><li><u>Introduction</u></li>
<li><u>Solutions</u><ul><li><u>Ignore it</u></li>
<li><u>Make modifications easy</u></li>
<li><u>Code defensively</u></li>
</ul></li>
<li><u>Important</u></li>
</ul></li>
<li><u>Memory reduction</u><ul><li><u>All vehicles</u></li>
<li><u>All attributes</u></li>
<li><u>More that 32 values</u></li>
<li><u>Excess dimensions</u></li>
</ul></li>
<li><u>CPU vs Memory</u></li>
<li><u>Lists</u><ul><li><u>Types</u></li>
<li><u>Mixed lists</u></li>
<li><u>Code</u></li>
</ul></li>
<li><u>Binary trees</u><ul><li><u>Example</u></li>
<li><u>Balanced and unbalanced</u></li>
<li><u>Modification</u><ul><li><u>Addition</u></li>
<li><u>Deletion</u></li>
</ul></li>
</ul></li>
</ul><font size="5"><font color="green"><b><u>Introduction</u></b></font></font><br>
<br>
These are just some techniques for making your code faster that I have picked up up on the way. Please note that I in no way pretend to be an authority on this subject, these are just what I know, others may know other methods, in which case please do share them as even if no-one else cares I would be interested in knowing them. Note also that many of these techniques apply to languages beside PAWN (the last one I wrote was accused of being stupid because PAWN does not have dynamic memory allocation (personally I think that's a good thing but there we go)), however a lot of other languages may incorporate bits of these into the compiler to do in-line optimisation.<br>
<br>
This does not promise to make your code good, just hopefully better. Also note that some bits are fairly complex, it's aimed as a more advanced tutorial, so it does make some assumptions about knowledge in some areas.<br>
<br>
<font size="5"><font color="green"><b><u>String optimisation</u></b></font></font><br>
<br>
For those of you who haven't read my thread on better string usage, it's here:<br>
<br>
<a href="https://sampforum.blast.hk/showthread.php?tid=55261" target="_blank">Why you shouldn't make your strings 256 cells big</a><br>
<br>
<font size="5"><font color="green"><b><u>State machines (automata)</u></b></font></font><br>
<br>
For those of you who haven't read my thread on state machines (automata), it's here:<br>
<br>
<a href="https://sampforum.blast.hk/showthread.php?tid=86850" target="_blank">State machines (automata)</a><br>
<br>
<font size="5"><font color="green"><b><u>Callback hooks</u></b></font></font><br>
<br>
For those of you who haven't read my thread on callback hooking for libraries, it's here:<br>
<br>
<a href="https://sampforum.blast.hk/showthread.php?tid=85907" target="_blank">Simpler library writing and usage</a><br>
<br>
<font size="5"><font color="green"><b><u>Interesting Macros</u></b></font></font><br>
<br>
This topic gives some very interesting uses for macros to make complex code simpler:<br>
<br>
<a href="https://sampforum.blast.hk/showthread.php?tid=103650" target="_blank">Interesting macros</a><br>
<br>
<font size="5"><font color="green"><b><u>Testing</u></b></font></font><br>
<br>
Firstly I'm going to explain my testing procedure. If I have two pieces of code which do the same thing but in different ways and I want to know which is faster I clock them:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:407px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222AA;">#define CODE_1 printf("%d", 42);</span><br><span style="color: #2222AA;">#define CODE_2 new str[4]; format(str, sizeof (str), "%d", 42); print(str);</span><br><span style="color: #2222AA;">#define ITERATIONS (10000)</span><br><br>Test<span style="color: #000000;">(</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; &nbsp; &nbsp; t0,<br>&nbsp; &nbsp; &nbsp; &nbsp; t1,<br>&nbsp; &nbsp; &nbsp; &nbsp; t2,<br>&nbsp; &nbsp; &nbsp; &nbsp; i;<br>&nbsp; &nbsp; t0 <span style="color: #000000;">=</span> GetTickCount<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; <span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span>i <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>; i <span style="color: #000000;">&lt;</span> ITERATIONS; i<span style="color: #000000;">++</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; CODE_1<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; t1 <span style="color: #000000;">=</span> GetTickCount<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; <span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span>i <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>; i <span style="color: #000000;">&lt;</span> ITERATIONS; i<span style="color: #000000;">++</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; CODE_2<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; t2 <span style="color: #000000;">=</span> GetTickCount<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; <span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"Time 1: %04d, time 2: %04d"</span>, t1 <span style="color: #000000;">-</span> t0, t2 <span style="color: #000000;">-</span> t1<span style="color: #000000;">)</span>;<br><span style="color: #000000;">}</span></div></div></pre>
</div>Clearly both the pieces of code will display the number "42" in the server console, however they both do it in different ways. Hopefully no-one will need to run this code to know which method will be faster, but it's a good simple example of testing to see which of two equivalent pieces of code is faster. The ITERATIONS loop is important, in all likelihood both of these pieces of code will take less than a millisecond each, so both will report their time taken as zero. Also, if you only do it once threading becomes a major issue, if one version is interrupted by the OS it can report itself as taking substantially longer when in fact it's faster. If both are done lots and lots of times then interrupts will hopefully negate each other and each loop will take more than one millisecond. The layout of the code is also important, all the variables are declared first to move their overhead outside of the loop (their execution time is so small it likely won't affect the outcome anyway, but just for consistency it's good).<br>
<br>
It's also sometimes good to wrap the Test function in another loop, especially if the results are very close, to verify the results. Execution times can vary slightly due to threads, this is visible if you run multiple tests in the form of maybe a few milliseconds variation on each time. If you run close results repeatedly then you can check than one is consistently faster rather than faster just the once, as that may have been a fluke and 90% of the time the other is faster, just not that one time.<br>
<br>
Sometimes you may need more advanced test code, e.g. to test more than two equivalents, this is fairly easy to expand:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:503px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222AA;">#define CODE_1 printf("%d", 42);</span><br><span style="color: #2222AA;">#define CODE_2 new str[4]; format(str, sizeof (str), "%d", 42); print(str);</span><br><span style="color: #2222AA;">#define CODE_3 print("42");</span><br><span style="color: #2222AA;">#define ITERATIONS (10000)</span><br><br>Test<span style="color: #000000;">(</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; &nbsp; &nbsp; t0,<br>&nbsp; &nbsp; &nbsp; &nbsp; t1,<br>&nbsp; &nbsp; &nbsp; &nbsp; t2,<br>&nbsp; &nbsp; &nbsp; &nbsp; t3,<br>&nbsp; &nbsp; &nbsp; &nbsp; i;<br>&nbsp; &nbsp; t0 <span style="color: #000000;">=</span> GetTickCount<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; <span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span>i <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>; i <span style="color: #000000;">&lt;</span> ITERATIONS; i<span style="color: #000000;">++</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; CODE_1<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; t1 <span style="color: #000000;">=</span> GetTickCount<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; <span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span>i <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>; i <span style="color: #000000;">&lt;</span> ITERATIONS; i<span style="color: #000000;">++</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; CODE_2<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; t2 <span style="color: #000000;">=</span> GetTickCount<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; <span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span>i <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>; i <span style="color: #000000;">&lt;</span> ITERATIONS; i<span style="color: #000000;">++</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; CODE_3<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; t3 <span style="color: #000000;">=</span> GetTickCount<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; <span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"Time 1: %04d, time 2: %04d, time 3: %04d"</span>, t1 <span style="color: #000000;">-</span> t0, t2 <span style="color: #000000;">-</span> t1, t3 <span style="color: #000000;">-</span> t2<span style="color: #000000;">)</span>;<br><span style="color: #000000;">}</span></div></div></pre>
</div>Etcetera...<ul><li><font size="2"><font color="green"><b><u>foreach</u></b></font></font></li>
</ul>I recently clocked my foreach function against the default for/IsPlayerConnected (IPC) code. foreach uses a linked list of players so when you loop it ONLY loops through connected players, compared to IPC code which loops through ALL players and checks if they're connected. I knew that on a large server with not many players it was faster, but I wasn't sure about more full servers, so I clocked it. I didn't have 200 players to test with but I know that IsPlayerConnected takes pretty much the same time to run whether it returns true or false (it basically just returns a variable in the server which could be either), so this wasn't a problem as for a given number of players IPC would run at a constant speed regardless of whether they were on or not. foreach runs very differently depending on how many players are connected, taking next to no time with no players and a lot longer for a full server, I just wanted to know if this longest execution time was longer than the constant time IPC ran at. I actually wanted to profile it at all player counts, this meant faking player connections in foreach, which wasn't hard as it's my code and you just call a connect function. The test code for this ended up looking like:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:503px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222AA;">#define FAKE_MAX 200</span><br><span style="color: #2222AA;">#define SKIP 0</span><br>Iter_Create<span style="color: #000000;">(</span>P2, FAKE_MAX<span style="color: #000000;">)</span>;<br>&nbsp;<br>TestFunc<span style="color: #000000;">(</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; &nbsp; &nbsp; fep <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; fet <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; fip <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; fit <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; i <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>;<br>&nbsp; &nbsp; <span style="color: #2222BB;">while</span> <span style="color: #000000;">(</span>i <span style="color: #000000;">&lt;</span> SKIP<span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; Itter_Add<span style="color: #000000;">(</span>P2, i<span style="color: #000000;">++</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">while</span> <span style="color: #000000;">(</span>i <span style="color: #000000;">&lt;=</span> FAKE_MAX<span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; t0,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; t1,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; t2,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; j;<br>&nbsp; &nbsp; &nbsp; &nbsp; t0 <span style="color: #000000;">=</span> GetTickCount<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span>j <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>; j <span style="color: #000000;">&lt;</span> <span style="color: #000000;">10000</span>; j<span style="color: #000000;">++</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span><span style="color: #2222BB;">new</span> playerid <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>; playerid <span style="color: #000000;">&lt;</span> FAKE_MAX; playerid<span style="color: #000000;">++</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>IsPlayerConnected<span style="color: #000000;">(</span>playerid<span style="color: #000000;">)</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #228822;">// Do something</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; &nbsp; &nbsp; t1 <span style="color: #000000;">=</span> GetTickCount<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span>j <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>; j <span style="color: #000000;">&lt;</span> <span style="color: #000000;">10000</span>; j<span style="color: #000000;">++</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach<span style="color: #000000;">(</span>P2, playerid<span style="color: #000000;">)</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #228822;">// Do something</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; &nbsp; &nbsp; t2 <span style="color: #000000;">=</span> GetTickCount<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"Players: %04d, for: %04d, foreach: %04d"</span>, i, t1 <span style="color: #000000;">-</span> t0, t2 <span style="color: #000000;">-</span> t1<span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; &nbsp; &nbsp; fit <span style="color: #000000;">=</span> fit <span style="color: #000000;">+</span> t1 <span style="color: #000000;">-</span> t0;<br>&nbsp; &nbsp; &nbsp; &nbsp; fet <span style="color: #000000;">=</span> fet <span style="color: #000000;">+</span> t2 <span style="color: #000000;">-</span> t1;<br>&nbsp; &nbsp; &nbsp; &nbsp; fip <span style="color: #000000;">+=</span> FAKE_MAX;<br>&nbsp; &nbsp; &nbsp; &nbsp; fep <span style="color: #000000;">+=</span> i;<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>i <span style="color: #000000;">&lt;</span> FAKE_MAX<span style="color: #000000;">)</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Itter_Add<span style="color: #000000;">(</span>P2, i<span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; &nbsp; &nbsp; i<span style="color: #000000;">++</span>;<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; <span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"for ms/p: %04d, foreach ms/p: %04d"</span>, <span style="color: #000000;">(</span>fit <span style="color: #000000;">*</span> <span style="color: #000000;">100</span><span style="color: #000000;">)</span> <span style="color: #000000;">/</span> fip, <span style="color: #000000;">(</span>fet <span style="color: #000000;">*</span> <span style="color: #000000;">100</span><span style="color: #000000;">)</span> <span style="color: #000000;">/</span> fep<span style="color: #000000;">)</span>;<br><span style="color: #000000;">}</span></div></div></pre>
</div>This ran the code 201 times, one for each player count (0-200) (with both foreach and IPC it doesn't matter WHICH players are connected in terms of speed). It also allowed me to fake more players, e.g. to test how this code would run on a 0.3 server with 500 players, IPC is actually slightly faster if the player you're testing doesn't exist, and it was STILL slower, so that was fairly conclusive. The one test I didn't run was:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:295px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;">t0 <span style="color: #000000;">=</span> GetTickCount<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span>j <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>; j <span style="color: #000000;">&lt;</span> <span style="color: #000000;">10000</span>; j<span style="color: #000000;">++</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span><span style="color: #2222BB;">new</span> playerid <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>; playerid <span style="color: #000000;">&lt;</span> FAKE_MAX; playerid<span style="color: #000000;">++</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Kick<span style="color: #000000;">(</span>playerid<span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; &nbsp; &nbsp; t1 <span style="color: #000000;">=</span> GetTickCount<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span>j <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>; j <span style="color: #000000;">&lt;</span> <span style="color: #000000;">10000</span>; j<span style="color: #000000;">++</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach<span style="color: #000000;">(</span>P2, playerid<span style="color: #000000;">)</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Kick<span style="color: #000000;">(</span>playerid<span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; &nbsp; &nbsp; t2 <span style="color: #000000;">=</span> GetTickCount<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</div></div></pre>
</div>Kick, and in fact all player functions, has an internal IsPlayerConnected check, so if you're only running one function in a loop it's more efficient to NOT call IsPlayerConnected and just call the function direct. If the player is connected you've saved a function call, if they're not connected you've not lost anything as the only code that's been executed is the same as if you called IsPlayerConnected. Unfortunately this example may affect the speed of foreach at high player counts as you will be using the foreach code AND the IPC code in the same loop. If you did:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:343px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;">t0 <span style="color: #000000;">=</span> GetTickCount<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span>j <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>; j <span style="color: #000000;">&lt;</span> <span style="color: #000000;">10000</span>; j<span style="color: #000000;">++</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span><span style="color: #2222BB;">new</span> playerid <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>; playerid <span style="color: #000000;">&lt;</span> FAKE_MAX; playerid<span style="color: #000000;">++</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>IsPlayerConnected<span style="color: #000000;">(</span>playerid<span style="color: #000000;">)</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Kick<span style="color: #000000;">(</span>playerid<span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; &nbsp; &nbsp; t1 <span style="color: #000000;">=</span> GetTickCount<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span>j <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>; j <span style="color: #000000;">&lt;</span> <span style="color: #000000;">10000</span>; j<span style="color: #000000;">++</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach<span style="color: #000000;">(</span>P2, playerid<span style="color: #000000;">)</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Kick<span style="color: #000000;">(</span>playerid<span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; &nbsp; &nbsp; t2 <span style="color: #000000;">=</span> GetTickCount<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</div></div></pre>
</div>Then foreach would be faster, but that's not the most efficient way of doing it in the first instance.<br>
<br>
I have actually looked into modifying a compiler so you can do something like:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 306px;
		text-align: left;
		overflow: auto">eqiv
{
    {
        for (new playerid = 0; playerid &lt; FAKE_MAX; playerid++)
        {
            if (IsPlayerConnected(playerid))
            {
                Kick(playerid);
            }
        }
    }
    {
        foreach(P2, playerid)
        {
            Kick(playerid);
        }
    }
}</pre>
</div>Which will compile and optimise both versions of the code, then accurately clock both based on generated code and known OpCode clock cycles to see which is faster. However there are all sorts of problems involved regarding test sets and I've not done it yet so it's really a moot point (truthfully there's a number of improvements I'd like to make to various language compilers, I've just not yet).<br>
<br>
<font size="5"><font color="green"><b><u>Minor optimisations</u></b></font></font><ul><li><font size="2"><font color="green"><b><u>IEEE numbers</u></b></font></font></li>
</ul>There is a float representation for positive and negative infinity, and one for invalid numbers. I've seen people try all sorts of representations for large or invalid float numbers, take these examples:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:103px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span><span style="color: #000000;">!</span>IsPlayerConnected<span style="color: #000000;">(</span>playerid<span style="color: #000000;">)</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">return</span> <span style="color: #000000;">-</span><span style="color: #000000;">1.0</span>;<br><span style="color: #000000;">}</span><br><span style="color: #2222BB;">return</span> GetDistance<span style="color: #000000;">(</span>playerid<span style="color: #000000;">)</span>;</div></div></pre>
</div><div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:343px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; <span style="color: #000000;">bool</span><span style="color: #000000;">:</span>first <span style="color: #000000;">=</span> true,<br>&nbsp; &nbsp; <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>distance <span style="color: #000000;">=</span> <span style="color: #000000;">0.0</span>;<br>foreach <span style="color: #000000;">(</span>Player, playerid<span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>first<span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; first <span style="color: #000000;">=</span> false;<br>&nbsp; &nbsp; &nbsp; &nbsp; distance <span style="color: #000000;">=</span> GetDistance<span style="color: #000000;">(</span>playerid<span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">else</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>temp <span style="color: #000000;">=</span> GetDistance<span style="color: #000000;">(</span>playerid<span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>temp <span style="color: #000000;">&lt;</span> distance<span style="color: #000000;">)</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; distance <span style="color: #000000;">=</span> temp;<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br><span style="color: #000000;">}</span></div></div></pre>
</div>The first code could do anything, with a distance of -1.0 meaning the player isn't connected, so retuning an invalid distance. The second code finds the closet player to something (exact details aren't important). The second piece of code can be optimised by choosing a very large start number instead of the "first" variable:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:199px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>distance <span style="color: #000000;">=</span> <span style="color: #000000;">100000.0</span>;<br>foreach <span style="color: #000000;">(</span>Player, playerid<span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>temp <span style="color: #000000;">=</span> GetDistance<span style="color: #000000;">(</span>playerid<span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>temp <span style="color: #000000;">&lt;</span> distance<span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; distance <span style="color: #000000;">=</span> temp;<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br><span style="color: #000000;">}</span></div></div></pre>
</div>But that misses the rare case when a player is over 100000 units away (note that in actual fact you would use squared values here, as detailed <u>below</u>, but this is for example only). Both of these examples have well defined solutions:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:71px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222AA;">#define FLOAT_INFINITY &nbsp; (Float:0x7F800000)</span><br><span style="color: #2222AA;">#define FLOAT_NEG_INFINITY (Float:0xFF800000)</span><br><span style="color: #2222AA;">#define FLOAT_NAN &nbsp; &nbsp; (Float:0xFFFFFFFF)</span></div></div></pre>
</div>This would make the code above:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:199px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>distance <span style="color: #000000;">=</span> FLOAT_INFINITY;<br>foreach <span style="color: #000000;">(</span>Player, playerid<span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>temp <span style="color: #000000;">=</span> GetDistance<span style="color: #000000;">(</span>playerid<span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>temp <span style="color: #000000;">&lt;</span> distance<span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; distance <span style="color: #000000;">=</span> temp;<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br><span style="color: #000000;">}</span></div></div></pre>
</div><div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:103px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span><span style="color: #000000;">!</span>IsPlayerConnected<span style="color: #000000;">(</span>playerid<span style="color: #000000;">)</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">return</span> FLOAT_NAN;<br><span style="color: #000000;">}</span><br><span style="color: #2222BB;">return</span> GetDistance<span style="color: #000000;">(</span>playerid<span style="color: #000000;">)</span>;</div></div></pre>
</div>"NaN" is a very special number - comparing it to any other number (including itself) will return false. To check for NaN you would do:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">stock</span> IsNaN<span style="color: #000000;">(</span>number<span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">return</span> <span style="color: #000000;">!</span><span style="color: #000000;">(</span>number <span style="color: #000000;">&lt;=</span> <span style="color: #000000;">0</span> || number <span style="color: #000000;">&gt;</span> <span style="color: #000000;">0</span><span style="color: #000000;">)</span>;<br><span style="color: #000000;">}</span></div></div></pre>
</div>That function returns false if the number passed is less than, equal to, or greater than 0 - all numbers, including + and - infinity, match those criteria - NaN DOESN'T because it's not a number, so doesn't have a value. Using these values guarantee (they're defined in the IEEE floating point number spec) that you will never use numbers which could be confused with real values. Due to the unique properties of NaN this very odd looking code should also work:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">stock</span> IsNaN<span style="color: #000000;">(</span>number<span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">return</span> <span style="color: #000000;">(</span>number <span style="color: #000000;">!=</span> number<span style="color: #000000;">)</span>;<br><span style="color: #000000;">}</span></div></div></pre>
</div>DO NOT TRY:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>number <span style="color: #000000;">==</span> FLOAT_NAN<span style="color: #000000;">)</span></div></div></pre>
</div>That code will fail because, as previously mentioned, NaN is not equal even to itself.<br>
<br>
Let's look at this when you want the distance to see if they're in range of something:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>DistanceWithConnectionCheck<span style="color: #000000;">(</span>playerid<span style="color: #000000;">)</span> <span style="color: #000000;">&lt;</span> <span style="color: #000000;">100.0</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #228822;">// They're in range and connected</span><br><span style="color: #000000;">}</span></div></div></pre>
</div>Returning infinity will mean the check fails, as will returning NaN (it's not less than, greater than or equal to 10) - compare this to the extra code you need here to check for "-1.0":<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:199px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>distance <span style="color: #000000;">=</span> DistanceWithConnectionCheck<span style="color: #000000;">(</span>playerid<span style="color: #000000;">)</span>;<br><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>distance <span style="color: #000000;">==</span> <span style="color: #000000;">-</span><span style="color: #000000;">1.0</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #228822;">// They're not connected</span><br><span style="color: #000000;">}</span><br><span style="color: #2222BB;">else</span> <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>distance <span style="color: #000000;">&lt;</span> <span style="color: #000000;">100.0</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #228822;">// They're in range and connected</span><br>&nbsp; &nbsp; <span style="color: #228822;">// -1.0 is less than 100, so we need to check for that specially</span><br><span style="color: #000000;">}</span></div></div></pre>
</div>See the YSI object streamer for a real usage.<ul><li><font size="2"><font color="green"><b><u>Rearranging</u></b></font></font></li>
</ul>The compiler can do constant maths, this means if you do:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"%d"</span>, <span style="color: #000000;">4</span> <span style="color: #000000;">+</span> <span style="color: #000000;">5</span><span style="color: #000000;">)</span>;</div></div></pre>
</div>The compiler will do:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"%d"</span>, <span style="color: #000000;">9</span><span style="color: #000000;">)</span>;</div></div></pre>
</div>It won't bother putting in code to do the maths as there's no point - it'll always be the same result. Often a simple formula rearrangement can help your code:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:55px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; var <span style="color: #000000;">=</span> <span style="color: #000000;">(</span><span style="color: #000000;">4</span> <span style="color: #000000;">+</span> somevar<span style="color: #000000;">)</span> <span style="color: #000000;">-</span> <span style="color: #000000;">11</span>;</div></div></pre>
</div>That will compile to do two bits of maths, first to add 4 to a number, then to subtract 11 from the result (some compilers may actually be able to optimise this in the way I'm about to describe, but it's a simple example). If you rearrange this sum you get:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:55px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; var <span style="color: #000000;">=</span> somevar <span style="color: #000000;">+</span> <span style="color: #000000;">(</span><span style="color: #000000;">4</span> <span style="color: #000000;">-</span> <span style="color: #000000;">11</span><span style="color: #000000;">)</span>;</div></div></pre>
</div>The compiler can very quickly optimise this to:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:55px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; var <span style="color: #000000;">=</span> somevar <span style="color: #000000;">-</span> <span style="color: #000000;">7</span>;</div></div></pre>
</div>A more complex example with no compiler optimisations:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; gLastTime<span style="color: #000000;">[</span>MAX_PLAYERS<span style="color: #000000;">]</span>;<br>&nbsp;<br><span style="color: #2222AA;">#define EXPIRY 1000</span></div></div></pre>
</div><div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:167px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; time <span style="color: #000000;">=</span> GetTickCount<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;<br>foreach <span style="color: #000000;">(</span>Player, playerid<span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>time <span style="color: #000000;">-</span> gLastTime<span style="color: #000000;">[</span>playerid<span style="color: #000000;">]</span> <span style="color: #000000;">&gt;</span> EXPIRY<span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; SendClientMessage<span style="color: #000000;">(</span>playerid, 0xFF0000AA, <span style="color: #000066;">"Your time expired"</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br><span style="color: #000000;">}</span></div></div></pre>
</div>That's a basic example which detects when a certain time has passed since a player last did something. No options for optimisation there you may think, and you may be right, but it's always better to try. The equation here is:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 34px;
		text-align: left;
		overflow: auto">time - gLastTime[playerid] &gt; EXPIRY</pre>
</div>=, ==, &gt;= etc can all be rearranged in the same way, so the above equation is the same as:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 34px;
		text-align: left;
		overflow: auto">time &gt; EXPIRY + gLastTime[playerid]</pre>
</div>More importantly, it is also the same as:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 34px;
		text-align: left;
		overflow: auto">time - EXPIRY &gt; gLastTime[playerid]</pre>
</div>Why is this important? In terms of the loop "time - EXPIRY" is now a constant as neither change in the loop. This means you can do:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:167px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; time <span style="color: #000000;">=</span> GetTickCount<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">-</span> EXPIRY;<br>foreach <span style="color: #000000;">(</span>Player, playerid<span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>time <span style="color: #000000;">&gt;</span> gLastTime<span style="color: #000000;">[</span>playerid<span style="color: #000000;">]</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; SendClientMessage<span style="color: #000000;">(</span>playerid, 0xFF0000AA, <span style="color: #000066;">"Your time expired"</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br><span style="color: #000000;">}</span></div></div></pre>
</div>You have just cut out up to 200 repeated subtractions with basically no effort. The more constant, or pseudo-constant, elements you can get in a sum the better, especially when you're doing lots of them. If you were only checking one player I'd be tempted to put everything, including the GetTickCount() call, in the if statement, but not if you're doing it multiple times.<ul><li><font size="2"><font color="green"><b><u>Data rearrangements</u></b></font></font></li>
</ul>Another thing to consider is how your data is laid out and how you want to access it. Take the following data for example:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:71px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222AA;">#define MAX_OWNDED_VEHICLES 10</span><br><br><span style="color: #2222BB;">new</span> gVehicleOwner<span style="color: #000000;">[</span>MAX_OWNDED_VEHICLES<span style="color: #000000;">]</span> <span style="color: #000000;">=</span> <span style="color: #000000;">{</span><span style="color: #000000;">0</span>, <span style="color: #000000;">2</span>, <span style="color: #000000;">4</span>, <span style="color: #000000;">6</span>, <span style="color: #000000;">8</span>, <span style="color: #000000;">10</span>, <span style="color: #000000;">12</span>, <span style="color: #000000;">14</span>, <span style="color: #000000;">16</span>, <span style="color: #000000;">18</span><span style="color: #000000;">}</span>;</div></div></pre>
</div>Here you have 10 vehicles, each with a player who owns them (assume for this example one player can only own up to one vehicle). If you want to find out who owns a vehicle you can simply do:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"The owner of vehicle %d is %d"</span>, vehicleid, gVehicleOwner<span style="color: #000000;">[</span>vehicleid<span style="color: #000000;">]</span><span style="color: #000000;">)</span>;</div></div></pre>
</div>But what if you want to find out which vehicle a player owns? For that you would need to do something like:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:215px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span> i <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>;<br><span style="color: #2222BB;">while</span> <span style="color: #000000;">(</span>i <span style="color: #000000;">&lt;</span> MAX_OWNDED_VEHICLES<span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>gVehicleOwner<span style="color: #000000;">[</span>i<span style="color: #000000;">]</span> <span style="color: #000000;">==</span> playerid<span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"Player %d owns vehicle %d"</span>, playerid, i<span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #2222BB;">break</span>;<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; i<span style="color: #000000;">++</span>;<br><span style="color: #000000;">}</span><br><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>i <span style="color: #000000;">==</span> MAX_OWNDED_VEHICLES<span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"Player %d does not own a vehicle"</span>, playerid<span style="color: #000000;">)</span>;</div></div></pre>
</div>Now lets look at it a different way round:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:71px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222AA;">#define MAX_PLAYERS 20</span><br><br><span style="color: #2222BB;">new</span> gPlayerVehicle<span style="color: #000000;">[</span>MAX_PLAYERS<span style="color: #000000;">]</span> <span style="color: #000000;">=</span> <span style="color: #000000;">{</span><span style="color: #000000;">0</span>, <span style="color: #000000;">-</span><span style="color: #000000;">1</span>, <span style="color: #000000;">1</span>, <span style="color: #000000;">-</span><span style="color: #000000;">1</span>, <span style="color: #000000;">2</span>, <span style="color: #000000;">-</span><span style="color: #000000;">1</span>, <span style="color: #000000;">3</span>, <span style="color: #000000;">-</span><span style="color: #000000;">1</span>, <span style="color: #000000;">4</span>, <span style="color: #000000;">-</span><span style="color: #000000;">1</span>, <span style="color: #000000;">5</span>, <span style="color: #000000;">-</span><span style="color: #000000;">1</span>, <span style="color: #000000;">6</span>, <span style="color: #000000;">-</span><span style="color: #000000;">1</span>, <span style="color: #000000;">7</span>, <span style="color: #000000;">-</span><span style="color: #000000;">1</span>, <span style="color: #000000;">8</span>, <span style="color: #000000;">-</span><span style="color: #000000;">1</span>, <span style="color: #000000;">9</span>, <span style="color: #000000;">-</span><span style="color: #000000;">1</span><span style="color: #000000;">}</span>;</div></div></pre>
</div>Now if you want to find out which vehicle a player owns it's just a simple array lookup, but if you want to see who owns a vehicle it's a loop. The question you need to consider here is which do you want to know more? If you don't care who owns a given vehicle but do care which vehicle someone owns then use the second layout, and vice-versa the first. If you use both a lot you may actually want to consider mirroring the data in two different arrays. This is a trade-off between speed and memory, and is a VERY common trade-off you find people dealing with. Personally I think speed is more important than memory in modern 32 and 64 bit processors so would use two arrays, but you may disagree given the multiple gigahertz that they run at so would use one array and a loop.<br>
<br>
Let's look at a far more clean-cut example that was actually in a topic I read recently. This example is VERY cut down, I'm only using 10 models here:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:103px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; gCars<span style="color: #000000;">[</span><span style="color: #000000;">]</span> <span style="color: #000000;">=</span> <span style="color: #000000;">{</span><span style="color: #000000;">400</span>, <span style="color: #000000;">403</span>, <span style="color: #000000;">404</span>, <span style="color: #000000;">406</span>, <span style="color: #000000;">408</span>, <span style="color: #000000;">409</span><span style="color: #000000;">}</span>,<br>&nbsp; &nbsp; gHeavyVehicles<span style="color: #000000;">[</span><span style="color: #000000;">]</span> <span style="color: #000000;">=</span> <span style="color: #000000;">{</span><span style="color: #000000;">400</span>, <span style="color: #000000;">402</span>, <span style="color: #000000;">408</span><span style="color: #000000;">}</span>,<br>&nbsp; &nbsp; gBoats<span style="color: #000000;">[</span><span style="color: #000000;">]</span> <span style="color: #000000;">=</span> <span style="color: #000000;">{</span><span style="color: #000000;">401</span>, <span style="color: #000000;">407</span><span style="color: #000000;">}</span>,<br>&nbsp; &nbsp; gFireEngines<span style="color: #000000;">[</span><span style="color: #000000;">]</span> <span style="color: #000000;">=</span> <span style="color: #000000;">{</span><span style="color: #000000;">402</span>, <span style="color: #000000;">405</span><span style="color: #000000;">}</span>;</div></div></pre>
</div>If you want to know if a model is a car you need to loop through "gCar" till you find that model or you reach the end. On the other hand with this code it's very easy to tell what model a car at a given position is, but this means nothing as is data you are unlikely to ever want to know. So the question is; why is it easy to get data you don't want and hard to get data you do want? That makes no sense at all... We know that for a given model we want to know if it's a car, so we need to change the code to use the model as the array index (offsetting by 400), same as we did above to find what vehicle a player owns:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:103px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; gIsACar<span style="color: #000000;">[</span><span style="color: #000000;">]</span> <span style="color: #000000;">=</span> <span style="color: #000000;">{</span><span style="color: #000000;">1</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">1</span>, <span style="color: #000000;">1</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">1</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">1</span>, <span style="color: #000000;">1</span><span style="color: #000000;">}</span>,<br>&nbsp; &nbsp; gIsAHeavyVehicle<span style="color: #000000;">[</span><span style="color: #000000;">]</span> <span style="color: #000000;">=</span> <span style="color: #000000;">{</span><span style="color: #000000;">1</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">1</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">1</span>, <span style="color: #000000;">0</span><span style="color: #000000;">}</span>,<br>&nbsp; &nbsp; gIsABoat<span style="color: #000000;">[</span><span style="color: #000000;">]</span> <span style="color: #000000;">=</span> <span style="color: #000000;">{</span><span style="color: #000000;">0</span>, <span style="color: #000000;">1</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">1</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span><span style="color: #000000;">}</span>,<br>&nbsp; &nbsp; gIsAFireEngine<span style="color: #000000;">[</span><span style="color: #000000;">]</span> <span style="color: #000000;">=</span> <span style="color: #000000;">{</span><span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">1</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">1</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span><span style="color: #000000;">}</span>;</div></div></pre>
</div>Now if you want to find out if a model is a car or not you simply do:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>gIsACar<span style="color: #000000;">[</span>model <span style="color: #000000;">-</span> <span style="color: #000000;">400</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span></div></div></pre>
</div>Isn't that SO much simpler and faster than a loop?<br>
<br>
Using an entire cell to store a boolean value (1 or 0) is also very inefficient, but we'll cover that later.<ul><li><font size="2"><font color="green"><b><u>Know the language</u></b></font></font></li>
</ul>And I mean WELL. As someone reminded me the other day (I had commented on it on IRC) a little while ago I found out that:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span><span style="color: #000000;">2</span> <span style="color: #000000;">&lt;=</span> a <span style="color: #000000;">&lt;=</span> <span style="color: #000000;">4</span><span style="color: #000000;">)</span></div></div></pre>
</div>Works in PAWN (it doesn't in C), I had thought it was like in C, so had been doing:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span><span style="color: #000000;">2</span> <span style="color: #000000;">&lt;=</span> a <span style="color: #000000;">&amp;&amp;</span> a <span style="color: #000000;">&lt;=</span> <span style="color: #000000;">4</span><span style="color: #000000;">)</span></div></div></pre>
</div>Not a vast improvement, but most of these aren't, it's the combined and repeated effect that's important.<br>
<br>
If, for example, you didn't know about the "&amp;" operator and you wanted to test if the second bit of a number was set you would need to do something like:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span><span style="color: #000000;">(</span>a <span style="color: #000000;">&lt;&lt;</span> <span style="color: #000000;">30</span><span style="color: #000000;">)</span> <span style="color: #000000;">&gt;&gt;&gt;</span> <span style="color: #000000;">31</span><span style="color: #000000;">)</span></div></div></pre>
</div>or:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span><span style="color: #000000;">(</span>a <span style="color: #000000;">%</span> <span style="color: #000000;">4</span><span style="color: #000000;">)</span> <span style="color: #000000;">&gt;&gt;&gt;</span> <span style="color: #000000;">1</span><span style="color: #000000;">)</span></div></div></pre>
</div>Both those pieces of code would ensure that only one bit of a number was set, and would do what you wanted, but it's far better to know about "&amp;":<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>a <span style="color: #000000;">&amp;</span> <span style="color: #000000;">2</span><span style="color: #000000;">)</span></div></div></pre>
</div>It's clearly faster (shifts aren't too bad, but MOD is VERY slow, out of the other two versions always go for the first if you have to go for one of them), it's also a lot more obvious what you're trying to do. If you don't know what it does - go read pawn-lang.pdf.<br>
<br>
This is clearly a very basic example but there are many many other examples. People tend to baulk when I tell them to read pawn-lang.pdf then wonder why I seem to know more about PAWN than they do, 2 + 2 = ... There's a reason I have it bookmarked, and it's not so I can quickly copy the link to post for people (although it is handy for that too).<br>
<br>
As my example at the start of this section shows, there's always something new for you to learn, no matter how much you may already know. I can think of two huge parts of PAWN that I don't know at all and the fact that I don't know of any other areas just means I don't know them yet, it doesn't mean they don't exist (it's hard to know what you don't know).<ul><li><font size="2"><font color="green"><b><u>Distance checks</u></b></font></font></li>
</ul>0.3 now supports distance checks automatically, just use:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;">IsPlayerInRangeOfPoint<span style="color: #000000;">(</span>playerid, <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>range, <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>x, <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>y, <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>z<span style="color: #000000;">)</span>;</div></div></pre>
</div>This is a very common thing for people do, and a very common thing for people to do wrong. Example:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>PlayerDistanceToPoint<span style="color: #000000;">(</span>playerid, <span style="color: #000000;">10.0</span>, <span style="color: #000000;">20.0</span>, <span style="color: #000000;">2.0</span><span style="color: #000000;">)</span> <span style="color: #000000;">&lt;=</span> <span style="color: #000000;">5.0</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #228822;">// They're near 10.0, 20.0, 2.0 - do something</span><br><span style="color: #000000;">}</span></div></div></pre>
</div>That code will work, will trigger when the player is in 5.0 units of a point, but getting the distance to a point is very slow. The equation to get the distance between two points (x1, y1, z1 and x2, y2, z2) is:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 34px;
		text-align: left;
		overflow: auto">(((x1 - x2) ^ 2) + ((y1 - y2) ^ 2) + ((z1 - z2) ^ 2)) ^ 0.5</pre>
</div>"^" in this case means power, not XOR, "^ 0.5" is square root (trust me - try it on a calculator). The most common implementation of this is:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #222222;">floatsqroot</span><span style="color: #000000;">(</span><span style="color: #222222;">floatadd</span><span style="color: #000000;">(</span><span style="color: #222222;">floatadd</span><span style="color: #000000;">(</span><span style="color: #222222;">floatpower</span><span style="color: #000000;">(</span><span style="color: #222222;">floatsub</span><span style="color: #000000;">(</span>x1, x2<span style="color: #000000;">)</span>, <span style="color: #000000;">2</span><span style="color: #000000;">)</span>, <span style="color: #222222;">floatpower</span><span style="color: #000000;">(</span><span style="color: #222222;">floatsub</span><span style="color: #000000;">(</span>y1, y2<span style="color: #000000;">)</span>, <span style="color: #000000;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>, <span style="color: #222222;">floatpower</span><span style="color: #000000;">(</span><span style="color: #222222;">floatsub</span><span style="color: #000000;">(</span>z1, z2<span style="color: #000000;">)</span>, <span style="color: #000000;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</div></div></pre>
</div>Don't ask me why whoever originally wrote it didn't bother using standard operators, I have no idea, but simplified this code is:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #222222;">floatsqroot</span><span style="color: #000000;">(</span><span style="color: #222222;">floatpower</span><span style="color: #000000;">(</span>x1 <span style="color: #000000;">-</span> x2, <span style="color: #000000;">2</span><span style="color: #000000;">)</span> <span style="color: #000000;">+</span> <span style="color: #222222;">floatpower</span><span style="color: #000000;">(</span>y1 <span style="color: #000000;">-</span> y2, <span style="color: #000000;">2</span><span style="color: #000000;">)</span> <span style="color: #000000;">+</span> <span style="color: #222222;">floatpower</span><span style="color: #000000;">(</span>z1 <span style="color: #000000;">-</span> z2, <span style="color: #000000;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</div></div></pre>
</div>Now, the first thing to note is that the code to raise something to a generic power is complicated, it doesn't optimise for simple ones like 2 it just uses the basic algorithm. We know that something to the power 2 is just that thing multiplied by itself (or you should do). 3^2 is the same as 3*3, 57^2 is the same as 57*57 etc. Multiplication is much simpler that power, so the code becomes:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #222222;">floatsqroot</span><span style="color: #000000;">(</span><span style="color: #000000;">(</span><span style="color: #000000;">(</span>x1 <span style="color: #000000;">-</span> x2<span style="color: #000000;">)</span> <span style="color: #000000;">*</span> <span style="color: #000000;">(</span>x1 <span style="color: #000000;">-</span> x2<span style="color: #000000;">)</span><span style="color: #000000;">)</span> <span style="color: #000000;">+</span> <span style="color: #000000;">(</span><span style="color: #000000;">(</span>y1 <span style="color: #000000;">-</span> y2<span style="color: #000000;">)</span> <span style="color: #000000;">*</span> <span style="color: #000000;">(</span>y1 <span style="color: #000000;">-</span> y2<span style="color: #000000;">)</span><span style="color: #000000;">)</span> <span style="color: #000000;">+</span> <span style="color: #000000;">(</span><span style="color: #000000;">(</span>z1 <span style="color: #000000;">-</span> z2<span style="color: #000000;">)</span> <span style="color: #000000;">*</span> <span style="color: #000000;">(</span>z1 <span style="color: #000000;">-</span> z2<span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</div></div></pre>
</div>You could remove some brackets, but there's no point, this is just as fast as the reduced bracket version and more explicit. There is now more code here, but it's much faster. Now the quest for optimisation gets more interesting. We do each of the subtractions twice, you could export these to variables to only do them once, but then you've got additional variable writes which may not offset the gain in speed:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;">x1 <span style="color: #000000;">-=</span> x2;<br>y1 <span style="color: #000000;">-=</span> y2;<br>z1 <span style="color: #000000;">-=</span> z2;<br><span style="color: #222222;">floatsqroot</span><span style="color: #000000;">(</span><span style="color: #000000;">(</span>x1 <span style="color: #000000;">*</span> x1<span style="color: #000000;">)</span> <span style="color: #000000;">+</span> <span style="color: #000000;">(</span>y1 <span style="color: #000000;">*</span> y1<span style="color: #000000;">)</span> <span style="color: #000000;">+</span> <span style="color: #000000;">(</span>z1 <span style="color: #000000;">*</span> z1<span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</div></div></pre>
</div>We now have our nice efficient code for getting someone's distance from something, but there's still one major problem - all the optimisations done so far are nothing compared to floatsqroot, that is an insanely inefficient function (well, it's not inefficient, it's actually very efficient, but that doesn't make it fast because it's so complicated). Believe it or not most of the time you don't actually need to know exactly how far from the point someone is, just whether they're near the point or not. Now you should have read the part on <u>rearranging</u> (if not, go read it again), so let's apply that here:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 34px;
		text-align: left;
		overflow: auto">((x * x) + (y * y) + (z * z)) ^ 0.5 &lt;= 5.0</pre>
</div>You can rearrange inequalities in exactly the same way as regular equations:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 66px;
		text-align: left;
		overflow: auto">((x * x) + (y * y) + (z * z)) ^ 0.5 &lt;= 5.0
(x * x) + (y * y) + (z * z) &lt;= 5.0 ^ 2
(x * x) + (y * y) + (z * z) &lt;= 5.0 * 5.0</pre>
</div>Anyone familiar with maths should be able to vouch for that very simple rearrangement. We know how to quickly square something (as I just told you), and we know that square-rooting is very slow, so that's a vast improvement:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>PlayerDistanceToPointSquared<span style="color: #000000;">(</span>playerid, <span style="color: #000000;">10.0</span>, <span style="color: #000000;">20.0</span>, <span style="color: #000000;">2.0</span><span style="color: #000000;">)</span> <span style="color: #000000;">&lt;=</span> <span style="color: #000000;">5.0</span> <span style="color: #000000;">*</span> <span style="color: #000000;">5.0</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #228822;">// They're near 10.0, 20.0, 2.0 - do something</span><br><span style="color: #000000;">}</span></div></div></pre>
</div>Or:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>IsPlayerInRangeOfPoint<span style="color: #000000;">(</span>playerid, <span style="color: #000000;">5.0</span>, <span style="color: #000000;">10.0</span>, <span style="color: #000000;">20.0</span>, <span style="color: #000000;">2.0</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #228822;">// They're near 10.0, 20.0, 2.0 - do something</span><br><span style="color: #000000;">}</span></div></div></pre>
</div><div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:215px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">stock</span> IsPlayerInRangeOfPoint<span style="color: #000000;">(</span>playerid, <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>range, <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>x, <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>y, <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>z<span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>px,<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>py,<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>pz;<br>&nbsp; &nbsp; GetPlayerPos<span style="color: #000000;">(</span>playerid, px, py, pz<span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; px <span style="color: #000000;">-=</span> x;<br>&nbsp; &nbsp; py <span style="color: #000000;">-=</span> y;<br>&nbsp; &nbsp; pz <span style="color: #000000;">-=</span> z;<br>&nbsp; &nbsp; <span style="color: #2222BB;">return</span> <span style="color: #000000;">(</span><span style="color: #000000;">(</span>px <span style="color: #000000;">*</span> px<span style="color: #000000;">)</span> <span style="color: #000000;">+</span> <span style="color: #000000;">(</span>py <span style="color: #000000;">*</span> py<span style="color: #000000;">)</span> <span style="color: #000000;">+</span> <span style="color: #000000;">(</span>pz <span style="color: #000000;">*</span> pz<span style="color: #000000;">)</span><span style="color: #000000;">)</span> <span style="color: #000000;">&lt;</span> <span style="color: #000000;">(</span>range <span style="color: #000000;">*</span> range<span style="color: #000000;">)</span>;<br><span style="color: #000000;">}</span></div></div></pre>
</div>You can write your own code of course, but for reasons I can't go into I STRONGLY suggest you use that function name and parameter order.<br>
<br>
Update:<br>
<br>
I've found the original timing analysis I did on this area and the results are not what some people would expect. I compared a whole load of different distance analysis functions, including less accurate ones people use for speed, for example:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:183px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;">Type1<span style="color: #000000;">(</span><span style="color: #000000;">Float</span><span style="color: #000000;">:</span>x1, <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>y1, <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>z1, <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>x2, <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>y2, <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>z2, <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>dist<span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; x1 <span style="color: #000000;">=</span> <span style="color: #000000;">(</span>x1 <span style="color: #000000;">&gt;</span> x2<span style="color: #000000;">)</span> <span style="color: #000000;">?</span> x1 <span style="color: #000000;">-</span> <span style="color: #000000;">x2</span> <span style="color: #000000;">:</span> x2 <span style="color: #000000;">-</span> x1;<br>&nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>x1 <span style="color: #000000;">&gt;</span> dist<span style="color: #000000;">)</span> <span style="color: #2222BB;">return</span> false;<br>&nbsp; &nbsp; y1 <span style="color: #000000;">=</span> <span style="color: #000000;">(</span>y1 <span style="color: #000000;">&gt;</span> y2<span style="color: #000000;">)</span> <span style="color: #000000;">?</span> y1 <span style="color: #000000;">-</span> <span style="color: #000000;">y2</span> <span style="color: #000000;">:</span> y2 <span style="color: #000000;">-</span> y1;<br>&nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>y1 <span style="color: #000000;">&gt;</span> dist<span style="color: #000000;">)</span> <span style="color: #2222BB;">return</span> false;<br>&nbsp; &nbsp; z1 <span style="color: #000000;">=</span> <span style="color: #000000;">(</span>z1 <span style="color: #000000;">&gt;</span> z2<span style="color: #000000;">)</span> <span style="color: #000000;">?</span> z1 <span style="color: #000000;">-</span> <span style="color: #000000;">z2</span> <span style="color: #000000;">:</span> z2 <span style="color: #000000;">-</span> z1;<br>&nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>z1 <span style="color: #000000;">&gt;</span> dist<span style="color: #000000;">)</span> <span style="color: #2222BB;">return</span> false;<br>&nbsp; &nbsp; <span style="color: #2222BB;">return</span> true;<br><span style="color: #000000;">}</span></div></div></pre>
</div>The results were that even these "faster" implementations were slower than the implementation outlined above, AND less accurate.<br>
<br>
The results I got were:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 34px;
		text-align: left;
		overflow: auto">1703 1781 1594 1641 2265 1782 2281 1891</pre>
</div>1703 is the time for the "faster" version, 1594 was the time for my version. Conclusion - don't try to optimise distance checks by making them worse - the originals are both faster and more accurate.<br>
<br>
Note that running the linked code will produce <b>9</b> values due to a bug - just ignore the last value (a fatal mistake I made).<br>
<br>
My analysis code can be found <a href="http://y-less.pastebin.ca/1299061" target="_blank">here</a>.<ul><li><font size="2"><font color="green"><b><u>Speed order</u></b></font></font></li>
</ul>Different language features take different times to execute, in general the order is (from fastest to slowest):<ul><li>Nothing</li>
<li>Constants</li>
<li>Variables</li>
<li>Arrays</li>
<li>Native functions</li>
<li>Custom functions</li>
<li>Remote functions</li>
</ul>So for example:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span><span style="color: #2222BB;">new</span> i <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>; i <span style="color: #000000;">&lt;</span> MAX_PLAYERS; i<span style="color: #000000;">++</span><span style="color: #000000;">)</span></div></div></pre>
</div>Is faster than:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span><span style="color: #2222BB;">new</span> i <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>, j <span style="color: #000000;">=</span> GetMaxPlayers<span style="color: #000000;">(</span><span style="color: #000000;">)</span>; i <span style="color: #000000;">&lt;</span> j; i<span style="color: #000000;">++</span><span style="color: #000000;">)</span></div></div></pre>
</div>As the main part of the loop in the first uses a constant, whereas the main part in the second uses a variable (the overhead of a single function call in a loop is negligible compared to the repeated check). This second version is itself faster than:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span><span style="color: #2222BB;">new</span> i <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>; i <span style="color: #000000;">&lt;</span> GetMaxPlayers<span style="color: #000000;">(</span><span style="color: #000000;">)</span>; i<span style="color: #000000;">++</span><span style="color: #000000;">)</span></div></div></pre>
</div>As this third version uses a repeated function call rather than a variable or constant.<br>
<br>
I'm not sure where control structures fit in to the list, for example I'm not sure which of these is faster:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:119px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span> var <span style="color: #000000;">=</span> a <span style="color: #000000;">?</span> <span style="color: #000000;">0</span> <span style="color: #000000;">:</span> <span style="color: #000000;">1</span>;<br><span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"%d"</span>, var<span style="color: #000000;">)</span>;<br><span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"%d"</span>, var<span style="color: #000000;">)</span>;<br><span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"%d"</span>, var<span style="color: #000000;">)</span>;<br><span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"%d"</span>, var<span style="color: #000000;">)</span>;<br><span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"%d"</span>, var<span style="color: #000000;">)</span>;</div></div></pre>
</div><div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:103px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"%d"</span>, a <span style="color: #000000;">?</span> <span style="color: #000000;">0</span> <span style="color: #000000;">:</span> <span style="color: #000000;">1</span><span style="color: #000000;">)</span>;<br><span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"%d"</span>, a <span style="color: #000000;">?</span> <span style="color: #000000;">0</span> <span style="color: #000000;">:</span> <span style="color: #000000;">1</span><span style="color: #000000;">)</span>;<br><span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"%d"</span>, a <span style="color: #000000;">?</span> <span style="color: #000000;">0</span> <span style="color: #000000;">:</span> <span style="color: #000000;">1</span><span style="color: #000000;">)</span>;<br><span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"%d"</span>, a <span style="color: #000000;">?</span> <span style="color: #000000;">0</span> <span style="color: #000000;">:</span> <span style="color: #000000;">1</span><span style="color: #000000;">)</span>;<br><span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"%d"</span>, a <span style="color: #000000;">?</span> <span style="color: #000000;">0</span> <span style="color: #000000;">:</span> <span style="color: #000000;">1</span><span style="color: #000000;">)</span>;</div></div></pre>
</div>I suspect the first, unless you only have one print, in which case definitely the second, but again there are for more complex examples where it's less clear. This requires clocking but I've not done it yet (and there are loads of control structures, so I just apply my general rule (see below) to these).<br>
<br>
So why is "nothing" in the list? Consider the following two bits of code:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:55px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span> var <span style="color: #000000;">=</span> <span style="color: #222222;">random</span><span style="color: #000000;">(</span><span style="color: #000000;">10</span><span style="color: #000000;">)</span>;<br><span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"%d"</span>, var<span style="color: #000000;">)</span>;</div></div></pre>
</div><div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"%d"</span>, <span style="color: #222222;">random</span><span style="color: #000000;">(</span><span style="color: #000000;">10</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</div></div></pre>
</div>Clearly the second is faster as there's no intermediary step. In actual fact most compilers will optimise out the variable but not all do.<br>
<br>
Where the line starts getting blurry is with repeated calls. For example, which of these is faster:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:55px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span> var <span style="color: #000000;">=</span> gArr<span style="color: #000000;">[</span><span style="color: #000000;">10</span><span style="color: #000000;">]</span>;<br><span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"%d %d"</span>, var, var<span style="color: #000000;">)</span>;</div></div></pre>
</div><div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"%d %d"</span>, gArr<span style="color: #000000;">[</span><span style="color: #000000;">10</span><span style="color: #000000;">]</span>, gArr<span style="color: #000000;">[</span><span style="color: #000000;">10</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span>;</div></div></pre>
</div>The first one has one array access, one variable write and two variable reads, the second has two array accesses. Truthfully I'm not sure which is faster but I have a general rule:<br>
<br>
More than one function call - save it in a variable, more than two array reads save it in a variable, so for the above code I would probably use the second version, however a three element print would require three array accesses, which is more than two, thus I would use an intermediary variable:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:55px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span> var <span style="color: #000000;">=</span> gArr<span style="color: #000000;">[</span><span style="color: #000000;">10</span><span style="color: #000000;">]</span>;<br><span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"%d %d %d"</span>, var, var, var<span style="color: #000000;">)</span>;</div></div></pre>
</div>And I never call the same function more than once when I don't have to (especially as this can have unintended results if the function has changing returns or side effects).<ul><li><font size="2"><font color="green"><b><u>Know your values</u></b></font></font></li>
</ul>Another common bit of code (I'm sure most of you will recognise it) is this:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>killerid <span style="color: #000000;">==</span> INVALID_PLAYER_ID<span style="color: #000000;">)</span><br>&nbsp; &nbsp; SendDeathMessage<span style="color: #000000;">(</span>INVALID_PLAYER_ID, playerid, reason<span style="color: #000000;">)</span>;<br><span style="color: #2222BB;">else</span><br>&nbsp; &nbsp; SendDeathMessage<span style="color: #000000;">(</span>killerid, playerid, reason<span style="color: #000000;">)</span>;</div></div></pre>
</div>Lets look at another example of similar code to try make it more obvious what exactly this is doing and why it's stupid:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>var <span style="color: #000000;">==</span> <span style="color: #000000;">1</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"%d"</span>, <span style="color: #000000;">1</span><span style="color: #000000;">)</span>;<br><span style="color: #2222BB;">else</span><br>&nbsp; &nbsp; <span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"%d"</span>, var<span style="color: #000000;">)</span>;</div></div></pre>
</div>If var is one this prints '1', if var isn't one this prints the value of var, either way the value of var gets printed, so what does the if do? This can just as easily be written:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #222222;">printf</span><span style="color: #000000;">(</span><span style="color: #000066;">"%d"</span>, var<span style="color: #000000;">)</span>;</div></div></pre>
</div>For the same reason, this does the same as the code above:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;">SendDeathMessage<span style="color: #000000;">(</span>killerid, playerid, reason<span style="color: #000000;">)</span>;</div></div></pre>
</div>The original code comes from the 0.2 version of LVDM, but in there other things were done too, making the check not pointless, but people took this, removed the other bits and didn't think about what the code was actually now doing. It doesn't matter if killerid isn't valid as as shown above INVALID_PLAYER_ID is a perfectly acceptable input to SendDeathMessage.<ul><li><font size="2"><font color="green"><b><u>Return values</u></b></font></font></li>
</ul>Contrary to what the wiki says, many function's return values are important as they indicate whether a (native) function succeeded or not. This can be utilised as we know from before that variables are faster than function calls, and doing things once is faster that doing things twice. An example:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:135px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span> <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>health;<br><span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span><span style="color: #2222BB;">new</span> i <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>; i <span style="color: #000000;">&lt;</span> <span style="color: #000000;">MAX_PLAYERS</span><span style="color: #000000;">:</span> i<span style="color: #000000;">++</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>IsPlayerConnected<span style="color: #000000;">(</span>i<span style="color: #000000;">)</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; GetPlayerHealth<span style="color: #000000;">(</span>i, health<span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; &nbsp; &nbsp; SetPlayerHealth<span style="color: #000000;">(</span>i, health <span style="color: #000000;">+</span> <span style="color: #000000;">10.0</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; <span style="color: #000000;">}</span></div></div></pre>
</div>Pretty self explanatory and typical code, but if we understand error returns this can be optimised. Due to bugs in 0.1 all player and vehicle functions now have checks to make sure the thing you’re operating on actually exists, so if you did GetPlayerHealth on a player that didn’t exist the function would fail and the health variable would have the same value as before. More importantly pretty much all functions without an important return value return 0 on failure and 1 on success. Internally the player connection check in GetPlayerHealth is more or less identical to the one in IsPlayerConnected, so we’re checking if a player is connected twice. If they’re not connected GetPlayerHealth will end instantly, so instead of the above code we can do:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span> <span style="color: #000000;">Float</span><span style="color: #000000;">:</span>health;<br><span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span><span style="color: #2222BB;">new</span> i <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>; i <span style="color: #000000;">&lt;</span> <span style="color: #000000;">MAX_PLAYERS</span><span style="color: #000000;">:</span> i<span style="color: #000000;">++</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>GetPlayerHealth<span style="color: #000000;">(</span>i, health<span style="color: #000000;">)</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; &nbsp; &nbsp; SetPlayerHealth<span style="color: #000000;">(</span>i, health <span style="color: #000000;">+</span> <span style="color: #000000;">10.0</span><span style="color: #000000;">)</span>;</div></div></pre>
</div>This is no slower for players not connected and faster for players who are, so worst case you get no improvement, best case loads.<br>
<br>
This can also be applied to other functions, even if they have return values:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:103px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>IsPlayerInAnyVehicle<span style="color: #000000;">(</span>playerid<span style="color: #000000;">)</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">new</span> vehicleid <span style="color: #000000;">=</span> GetPlayerVehicleID<span style="color: #000000;">(</span>playerid<span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; SetVehiclePos<span style="color: #000000;">(</span>vehicleid, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">10.0</span><span style="color: #000000;">)</span>;<br><span style="color: #000000;">}</span></div></div></pre>
</div>Again, an example of very common code, but again we need to ask what do these functions actually return? GetPlayerVehicleID returns the ID of the vehicle the player is in, and if they’re not in a vehicle it returns 0 (as this is an invalid vehicle ID). So, if we’re going to get the ID of the vehicle they’re in and this knows if they’re in a vehicle or not and can tell you, why check if they’re in one?<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:71px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span> vehicleid <span style="color: #000000;">=</span> GetPlayerVehicleID<span style="color: #000000;">(</span>playerid<span style="color: #000000;">)</span>;<br><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>vehicleid<span style="color: #000000;">)</span><br>&nbsp; &nbsp; SetVehiclePos<span style="color: #000000;">(</span>vehicleid, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">10.0</span><span style="color: #000000;">)</span>;</div></div></pre>
</div>Now, instead of two function calls you only have one and you check the return of that one is valid (i.e. not 0).<br>
<br>
One other aspect of return values is how long they exist for. If you set a variable in an if statement (which, if you’re not careful, will give an unintended assignment warning) the value you just set is still in the if statement, so if you did:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; a <span style="color: #000000;">=</span> <span style="color: #000000;">1</span>,<br>&nbsp; &nbsp; b <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>;<br><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span><span style="color: #000000;">(</span>b <span style="color: #000000;">=</span> a<span style="color: #000000;">)</span><span style="color: #000000;">)</span></div></div></pre>
</div>(Note the double brackets to avoid the unintended assignment warning)<br>
<br>
Then "a" would be assigned to "b", so "b" would be 1, and that 1 would still be active in the if effectively as the return of the assignment, so this if is true, however:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; a <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>,<br>&nbsp; &nbsp; b <span style="color: #000000;">=</span> <span style="color: #000000;">1</span>;<br><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span><span style="color: #000000;">(</span>b <span style="color: #000000;">=</span> a<span style="color: #000000;">)</span><span style="color: #000000;">)</span></div></div></pre>
</div>After this code "b" will be 0, as "a" has successfully been assigned to "b", but as the result of this assignment is 0, the if fails. Just to illustrate this, figure this code out (re-read the part on strings if you need to):<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:103px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">stock</span> strcpy<span style="color: #000000;">(</span>dest<span style="color: #000000;">[</span><span style="color: #000000;">]</span>, src<span style="color: #000000;">[</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">new</span> i <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>;<br>&nbsp; &nbsp; <span style="color: #2222BB;">while</span> <span style="color: #000000;">(</span><span style="color: #000000;">(</span>dest<span style="color: #000000;">[</span>i<span style="color: #000000;">]</span> <span style="color: #000000;">=</span> src<span style="color: #000000;">[</span>i<span style="color: #000000;">]</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span> i<span style="color: #000000;">++</span>;<br><span style="color: #000000;">}</span></div></div></pre>
</div>This also means you can do:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span> vehicleid;<br><span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span><span style="color: #2222BB;">new</span> i <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>; i <span style="color: #000000;">&lt;</span> <span style="color: #000000;">MAX_PLAYERS</span><span style="color: #000000;">:</span> i<span style="color: #000000;">++</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span><span style="color: #000000;">(</span>vehicleid <span style="color: #000000;">=</span> GetPlayerVehicleID<span style="color: #000000;">(</span>i<span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; &nbsp; &nbsp; SetVehiclePos<span style="color: #000000;">(</span>vehicleid, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">10.0</span><span style="color: #000000;">)</span>;</div></div></pre>
</div>Example of a player name check implementation in PAWN using this:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:151px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;">NameCheck<span style="color: #000000;">(</span>name<span style="color: #000000;">[</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; &nbsp; &nbsp; i,<br>&nbsp; &nbsp; &nbsp; &nbsp; ch;<br>&nbsp; &nbsp; <span style="color: #2222BB;">while</span> <span style="color: #000000;">(</span><span style="color: #000000;">(</span>ch <span style="color: #000000;">=</span> name<span style="color: #000000;">[</span>i<span style="color: #000000;">++</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span> <span style="color: #000000;">&amp;&amp;</span> <span style="color: #000000;">(</span><span style="color: #000000;">(</span>ch <span style="color: #000000;">==</span> <span style="color: #000066;">']'</span><span style="color: #000000;">)</span> || <span style="color: #000000;">(</span>ch <span style="color: #000000;">==</span> <span style="color: #000066;">'['</span><span style="color: #000000;">)</span> || <span style="color: #000000;">(</span>ch <span style="color: #000000;">==</span> <span style="color: #000066;">'_'</span><span style="color: #000000;">)</span> || <span style="color: #000000;">(</span><span style="color: #000066;">'0'</span> <span style="color: #000000;">&lt;=</span> ch <span style="color: #000000;">&lt;=</span> <span style="color: #000066;">'9'</span><span style="color: #000000;">)</span> || <span style="color: #000000;">(</span><span style="color: #000000;">(</span>ch |<span style="color: #000000;">=</span> 0x20<span style="color: #000000;">)</span> <span style="color: #000000;">&amp;&amp;</span> <span style="color: #000000;">(</span><span style="color: #000066;">'a'</span> <span style="color: #000000;">&lt;=</span> ch <span style="color: #000000;">&lt;=</span> <span style="color: #000066;">'z'</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span><span style="color: #000000;">}</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">return</span> <span style="color: #000000;">!</span>ch;<br><span style="color: #000000;">}</span></div></div></pre>
</div>This function will return true if the name is OK (i.e. all 0-9, a-z, A-Z, [, ] or _) and false if not. The (ch |= 0x20) is another little trick to convert a character to lower case, whatever it's previous case, based on the fact that in ASCII upper and lower case characters are exactly 0x20 apart (A = 0x40, a = 0x60).<ul><li><font size="2"><font color="green"><b><u>Small snippets</u></b></font></font></li>
</ul><ul><li><u>Equivalence</u></li>
</ul>Multiple things can mean the same thing, for example:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>string<span style="color: #000000;">[</span><span style="color: #000000;">1</span><span style="color: #000000;">]</span> <span style="color: #000000;">==</span> <span style="color: #000000;">65</span><span style="color: #000000;">)</span></div></div></pre>
</div>Is the same as:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>string<span style="color: #000000;">[</span><span style="color: #000000;">1</span><span style="color: #000000;">]</span> <span style="color: #000000;">==</span> 0x41<span style="color: #000000;">)</span></div></div></pre>
</div>Is the same as:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>string<span style="color: #000000;">[</span><span style="color: #000000;">1</span><span style="color: #000000;">]</span> <span style="color: #000000;">==</span> 0b01000001<span style="color: #000000;">)</span></div></div></pre>
</div>Is the same as:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>string<span style="color: #000000;">[</span><span style="color: #000000;">1</span><span style="color: #000000;">]</span> <span style="color: #000000;">==</span> <span style="color: #000066;">'A'</span><span style="color: #000000;">)</span></div></div></pre>
</div>Although they all mean the same thing and thus won't get any speed improvements the last one is more obvious as to what you're trying to do (check if a character is 'A'). However in other circumstances one of the other two may be more appropriate, i.e. you want to see if something is 65, and the fact that that's the same as 'A' is merely coincidence.<br>
<br>
This can be taken a bit further with zero:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>string<span style="color: #000000;">[</span><span style="color: #000000;">1</span><span style="color: #000000;">]</span> <span style="color: #000000;">==</span> <span style="color: #000000;">0</span><span style="color: #000000;">)</span></div></div></pre>
</div>Is the same as:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>string<span style="color: #000000;">[</span><span style="color: #000000;">1</span><span style="color: #000000;">]</span> <span style="color: #000000;">==</span> 0x00<span style="color: #000000;">)</span></div></div></pre>
</div>Is the same as:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>string<span style="color: #000000;">[</span><span style="color: #000000;">1</span><span style="color: #000000;">]</span> <span style="color: #000000;">==</span> <span style="color: #000000;">(</span><span style="color: #000000;">(</span><span style="color: #000000;">27</span> <span style="color: #000000;">+</span> <span style="color: #000000;">3</span><span style="color: #000000;">)</span> <span style="color: #000000;">/</span> <span style="color: #000000;">5</span><span style="color: #000000;">)</span> <span style="color: #000000;">-</span> <span style="color: #000000;">6</span><span style="color: #000000;">)</span></div></div></pre>
</div>Is the same as:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>string<span style="color: #000000;">[</span><span style="color: #000000;">1</span><span style="color: #000000;">]</span> <span style="color: #000000;">==</span> 0b00000000<span style="color: #000000;">)</span></div></div></pre>
</div>Is the same as:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>string<span style="color: #000000;">[</span><span style="color: #000000;">1</span><span style="color: #000000;">]</span> <span style="color: #000000;">==</span> <span style="color: #000066;">'<span style="color: #000099; font-weight: bold;">\0</span>'</span><span style="color: #000000;">)</span></div></div></pre>
</div>Is the same as:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>string<span style="color: #000000;">[</span><span style="color: #000000;">1</span><span style="color: #000000;">]</span> <span style="color: #000000;">==</span> false<span style="color: #000000;">)</span></div></div></pre>
</div>Is the same as:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>string<span style="color: #000000;">[</span><span style="color: #000000;">1</span><span style="color: #000000;">]</span> <span style="color: #000000;">!=</span> true<span style="color: #000000;">)</span></div></div></pre>
</div>Is the same as:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>string<span style="color: #000000;">[</span><span style="color: #000000;">1</span><span style="color: #000000;">]</span> <span style="color: #000000;">==</span> <span style="color: #000000;">0.0</span><span style="color: #000000;">)</span></div></div></pre>
</div>Is the same as:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span><span style="color: #000000;">!</span>string<span style="color: #000000;">[</span><span style="color: #000000;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span></div></div></pre>
</div>In fact that can be taken a lot further (floatround_round, radian, SPECIAL_ACTION_NONE, seek_start, io_read and PLAYER_STATE_NONE are all also 0).<ul><li><u>Empty strings</u></li>
</ul>The standard way of checking if a string is empty is:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span><span style="color: #222222;">strlen</span><span style="color: #000000;">(</span>string<span style="color: #000000;">)</span> <span style="color: #000000;">==</span> <span style="color: #000000;">0</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #228822;">// The string is empty because it's length is 0</span><br><span style="color: #000000;">}</span></div></div></pre>
</div>This clearly does check if a string is empty, and is fast if the string is empty, but is slower if the string isn't empty. The way strlen works is by looping through the string until it finds the end (which, as you should know from the other topic on strings, is denoted by a NULL character), once the end is hit the length is returned, so if the string isn't empty it will take a while to find the end.<br>
<br>
As we know that the end of a string is denoted by a NULL character all we need to do to see if a string is empty is to see if the first character is the end of the string or not:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>string<span style="color: #000000;">[</span><span style="color: #000000;">0</span><span style="color: #000000;">]</span> <span style="color: #000000;">==</span> <span style="color: #000066;">'<span style="color: #000099; font-weight: bold;">\0</span>'</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #228822;">// The string is empty because it's first character is the end</span><br><span style="color: #000000;">}</span></div></div></pre>
</div>This can be further improved:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span><span style="color: #000000;">!</span>string<span style="color: #000000;">[</span><span style="color: #000000;">0</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #228822;">// The string is empty because it's first character doesn't exist</span><br><span style="color: #000000;">}</span></div></div></pre>
</div>The only place this doesn't apply is in strings passed by CallRemoteFunction and CallLocalFunction. Due to the way the PAWN VM works these strings MUST NOT have 0 length, so empty strings are passed as "\1\0" (i.e. character 1 (SOH), character 0 (NULL)). To check for this do:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>string<span style="color: #000000;">[</span><span style="color: #000000;">0</span><span style="color: #000000;">]</span> <span style="color: #000000;">==</span> <span style="color: #000066;">'<span style="color: #000099; font-weight: bold;">\1</span>'</span> <span style="color: #000000;">&amp;&amp;</span> string<span style="color: #000000;">[</span><span style="color: #000000;">1</span><span style="color: #000000;">]</span> <span style="color: #000000;">==</span> <span style="color: #000066;">'<span style="color: #000099; font-weight: bold;">\0</span>'</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #228822;">// The string is empty because it's specially marked as empty</span><br><span style="color: #000000;">}</span></div></div></pre>
</div>Or, using isnull from YSI:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:55px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222AA;">#define isnull(%1) \</span><br>&nbsp; &nbsp; <span style="color: #000000;">(</span><span style="color: #000000;">(</span><span style="color: #000000;">!</span><span style="color: #000000;">(</span><span style="color: #000000;">%</span>1<span style="color: #000000;">[</span><span style="color: #000000;">0</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span> || <span style="color: #000000;">(</span><span style="color: #000000;">(</span><span style="color: #000000;">(</span><span style="color: #000000;">%</span>1<span style="color: #000000;">[</span><span style="color: #000000;">0</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span> <span style="color: #000000;">==</span> <span style="color: #000066;">'<span style="color: #000099; font-weight: bold;">\1</span>'</span><span style="color: #000000;">)</span> <span style="color: #000000;">&amp;&amp;</span> <span style="color: #000000;">(</span><span style="color: #000000;">!</span><span style="color: #000000;">(</span><span style="color: #000000;">%</span>1<span style="color: #000000;">[</span><span style="color: #000000;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span></div></div></pre>
</div><div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>isnull<span style="color: #000000;">(</span>string<span style="color: #000000;">)</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #228822;">// The string is empty because isnull said so</span><br><span style="color: #000000;">}</span></div></div></pre>
</div><a href="http://forum.sa-mp.com/index.php?topic=79810.msg525891#msg525891" target="_blank">Credit to Simon for the suggestion.</a><ul><li><u>Copying strings</u></li>
</ul>A lot of people tend to copy strings like this:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #222222;">format</span><span style="color: #000000;">(</span>dest, <span style="color: #2222BB;">sizeof</span> <span style="color: #000000;">(</span>dest<span style="color: #000000;">)</span>, <span style="color: #000066;">"%s"</span>, src<span style="color: #000000;">)</span>;</div></div></pre>
</div>This is one of the worst ways to do it! I did timings on six different methods of copying strings, in all cases "b" is the destination and "a" is the source. "strcpy" is a hand written PAWN function to copy strings:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:215px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #222222;">strmid</span><span style="color: #000000;">(</span>b, a, <span style="color: #000000;">0</span>, <span style="color: #222222;">strlen</span><span style="color: #000000;">(</span>a<span style="color: #000000;">)</span>, <span style="color: #2222BB;">sizeof</span> <span style="color: #000000;">(</span>b<span style="color: #000000;">)</span><span style="color: #000000;">)</span>;<br><br><span style="color: #222222;">format</span><span style="color: #000000;">(</span>b, <span style="color: #2222BB;">sizeof</span> <span style="color: #000000;">(</span>b<span style="color: #000000;">)</span>, <span style="color: #000066;">"%s"</span>, a<span style="color: #000000;">)</span>;<br><br>b<span style="color: #000000;">[</span><span style="color: #000000;">0</span><span style="color: #000000;">]</span> <span style="color: #000000;">=</span> <span style="color: #000066;">'<span style="color: #000099; font-weight: bold;">\0</span>'</span>;<br><span style="color: #222222;">strcat</span><span style="color: #000000;">(</span>b, a, <span style="color: #2222BB;">sizeof</span> <span style="color: #000000;">(</span>b<span style="color: #000000;">)</span><span style="color: #000000;">)</span>;<br><br><span style="color: #222222;">memcpy</span><span style="color: #000000;">(</span>b, a, <span style="color: #000000;">0</span>, <span style="color: #222222;">strlen</span><span style="color: #000000;">(</span>a<span style="color: #000000;">)</span> <span style="color: #000000;">*</span> <span style="color: #000000;">4</span> <span style="color: #000000;">+</span> <span style="color: #000000;">4</span>, <span style="color: #2222BB;">sizeof</span> <span style="color: #000000;">(</span>b<span style="color: #000000;">)</span><span style="color: #000000;">)</span>; <span style="color: #228822;">// Length in bytes, not cells.</span><br><br>strcpy<span style="color: #000000;">(</span>b, a<span style="color: #000000;">)</span>;<br><br>b <span style="color: #000000;">=</span> a;</div></div></pre>
</div>Note that "b = a;" is the standard PAWN array copy and only works for arrays known at compile time to be the same size, or with a larger desination. Unfortunately I ran a range of tests and they do not point to a single best function. What they DO do is show quite clearly that both the hand coded PAWN version and format are very slow at copying strings:<br>
<br>
For short strings in small arrays, "b = a;" is fastest when applicable, strcat with prior NULL termination (important) is second.<br>
<br>
For short strings in large arrays, strcat is fastest.<br>
<br>
For longer strings in longer arrays, "b = a;" is again fastest, with memcpy second.<br>
<br>
For huge arrays "b = a;" seems to be fastest.<br>
<br>
Where possible use standard array assignment, however this is not always possible, for example when a string of unknown size is passed to a function. In these cases I would suggest using strcat (if you're interested, note the bizzare syntax):<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:55px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222AA;">#define strcpy(%0,%1,%2) \</span><br>&nbsp; &nbsp; <span style="color: #222222;">strcat</span><span style="color: #000000;">(</span><span style="color: #000000;">(</span><span style="color: #000000;">%</span>0<span style="color: #000000;">[</span><span style="color: #000000;">0</span><span style="color: #000000;">]</span> <span style="color: #000000;">=</span> <span style="color: #000066;">'<span style="color: #000099; font-weight: bold;">\0</span>'</span>, <span style="color: #000000;">%</span>0<span style="color: #000000;">)</span>, <span style="color: #000000;">%</span>1, <span style="color: #000000;">%</span>2<span style="color: #000000;">)</span></div></div></pre>
</div>Use:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;">strcpy<span style="color: #000000;">(</span>dest, src, <span style="color: #2222BB;">sizeof</span> <span style="color: #000000;">(</span>dest<span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</div></div></pre>
</div>Credit to Simon for the suggestion.<br>
<br>
<font size="5"><font color="green"><b><u>Assumptions</u></b></font></font><ul><li><font size="2"><font color="green"><b><u>Introduction</u></b></font></font></li>
</ul><u>The bottom line is don't make assumptions!</u><br>
Assumptions are saying you know what something always is just because it's often that. Example:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:359px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">public</span> OnGameModeInit<span style="color: #000000;">(</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; AddPlayerClass<span style="color: #000000;">(</span><span style="color: #000000;">167</span>, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">5.0</span>, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span><span style="color: #000000;">)</span>; <span style="color: #228822;">// Clucking Bell employee</span><br>&nbsp; &nbsp; AddPlayerClass<span style="color: #000000;">(</span><span style="color: #000000;">179</span>, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">5.0</span>, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span><span style="color: #000000;">)</span>; <span style="color: #228822;">// Ammunation employee</span><br><span style="color: #000000;">}</span><br><br><span style="color: #2222BB;">public</span> OnPlayerRequestClass<span style="color: #000000;">(</span>playerid, classid<span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">switch</span> <span style="color: #000000;">(</span>classid<span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #2222BB;">case</span> <span style="color: #000000;">0</span><span style="color: #000000;">:</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GameTextForPlayer<span style="color: #000000;">(</span>playerid, <span style="color: #000066;">"Clucking Bell"</span>, <span style="color: #000000;">5000</span>, <span style="color: #000000;">3</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #2222BB;">case</span> <span style="color: #000000;">1</span><span style="color: #000000;">:</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GameTextForPlayer<span style="color: #000000;">(</span>playerid, <span style="color: #000066;">"Ammunation"</span>, <span style="color: #000000;">5000</span>, <span style="color: #000000;">3</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">return</span> <span style="color: #000000;">1</span>;<br><span style="color: #000000;">}</span></div></div></pre>
</div>That's probably very familiar looking code to almost every one of you - setting up your mode's skins and doing things based on the selected one (I've omitted setting cameras here as it's irrelevant to the point). On your own private server this may be fine, you know there's only two skins, you know what order they're added in, and you know they'll never be modified - fine. But if you're going to release a mode this is VERY risky. A few problems which can arise:<ul><li>A person using your mode also has filterscripts which add skins. This will throw off your class values.</li>
<li>A person using your mode decides they want to add skins and add them to the start of the list. This again throws off your class values.</li>
<li>A SA:MP version change alters the way IDs are assigned. Entirely altering your class IDs.</li>
</ul>I'm sure there are more but those are the basics. The problem here is that you're using constants and assuming that they'll never change, either through mode modification or through AddPlayerClass not returning what you expect. There are a few solutions to this problem.<ul><li><font size="2"><font color="green"><b><u>Solutions</u></b></font></font></li>
</ul><ul><li><u>Ignore it</u></li>
</ul>If people want to use your mode differently to how you intended, that's their own problem and they can modify the code accordingly. I'm sure everyone here has experience with people asking why, when they add new vehicles to GF, do all the other house and job cars mess up. This is because GF, which was coded for a single server with the intention of not being modified, made assumptions about what cars there were.<br>
<br>
This is clearly not a solution at all.<ul><li><u>Make modifications easy</u></li>
</ul>The second solution, which balances efficiency and modification, is to make the assumptions, but to minimise their usage. You may have commands which rely on the chose skin, in which case you may have code like:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:103px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;">dcmd_chicken<span style="color: #000000;">(</span>playerid, params<span style="color: #000000;">[</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>gClass<span style="color: #000000;">[</span>playerid<span style="color: #000000;">]</span> <span style="color: #000000;">!=</span> <span style="color: #000000;">0</span><span style="color: #000000;">)</span> <span style="color: #2222BB;">return</span> SendClientMessage<span style="color: #000000;">(</span>playerid, 0xFF0000AA, <span style="color: #000066;">"Sorry, you're not a Clucking Bell employee"</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; ...<br><span style="color: #000000;">}</span></div></div></pre>
</div>Your assumption that the Clucking Bell class is class 0 is now in your mode twice - once in OnPlayerRequestClass and once in dcmd_chicken. Assuming your mode is more than 20 lines long you could end up with this appearing hundreds of times, making modification a nightmare as you have to ensure you get every instance. The simplest way to get round this is use a define (or an enum):<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:503px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222AA;">#define CLUCKING_BELL_CLASS (0)</span><br><span style="color: #2222AA;">#define AMMUNATION_CLASS (1)</span><br><br><span style="color: #2222BB;">public</span> OnGameModeInit<span style="color: #000000;">(</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; AddPlayerClass<span style="color: #000000;">(</span><span style="color: #000000;">167</span>, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">5.0</span>, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span><span style="color: #000000;">)</span>; <span style="color: #228822;">// Clucking Bell employee</span><br>&nbsp; &nbsp; AddPlayerClass<span style="color: #000000;">(</span><span style="color: #000000;">179</span>, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">5.0</span>, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span><span style="color: #000000;">)</span>; <span style="color: #228822;">// Ammunation employee</span><br><span style="color: #000000;">}</span><br><br><span style="color: #2222BB;">public</span> OnPlayerRequestClass<span style="color: #000000;">(</span>playerid, classid<span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">switch</span> <span style="color: #000000;">(</span>classid<span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #2222BB;">case</span> CLUCKING_BELL_CLASS<span style="color: #000000;">:</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GameTextForPlayer<span style="color: #000000;">(</span>playerid, <span style="color: #000066;">"Clucking Bell"</span>, <span style="color: #000000;">5000</span>, <span style="color: #000000;">3</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #2222BB;">case</span> AMMUNATION_CLASS<span style="color: #000000;">:</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GameTextForPlayer<span style="color: #000000;">(</span>playerid, <span style="color: #000066;">"Ammunation"</span>, <span style="color: #000000;">5000</span>, <span style="color: #000000;">3</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">return</span> <span style="color: #000000;">1</span>;<br><span style="color: #000000;">}</span><br><br>dcmd_chicken<span style="color: #000000;">(</span>playerid, params<span style="color: #000000;">[</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>gClass<span style="color: #000000;">[</span>playerid<span style="color: #000000;">]</span> <span style="color: #000000;">!=</span> CLUCKING_BELL_CLASS<span style="color: #000000;">)</span> <span style="color: #2222BB;">return</span> SendClientMessage<span style="color: #000000;">(</span>playerid, 0xFF0000AA, <span style="color: #000066;">"Sorry, you're not a Clucking Bell employee"</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; ...<br><span style="color: #000000;">}</span></div></div></pre>
</div>Now when you add a new skin to the beginning of the list, or when you run a filterscript with it's own skins, you need only modify one part of your mode to reflect this change. However this can still cause problems if you can't guarantee that a return will always be constant.<ul><li><u>Code defensively</u></li>
</ul>The only way to guarantee that you'll never run into problems is to not make any assumptions at all. Save return values and use those known saves, don't try to guess what it might be:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:471px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; gCluckingBellSkin <span style="color: #000000;">=</span> <span style="color: #000000;">-</span><span style="color: #000000;">1</span>,<br>&nbsp; &nbsp; gAmmunationSkin <span style="color: #000000;">=</span> <span style="color: #000000;">-</span><span style="color: #000000;">1</span>;<br><br><span style="color: #2222BB;">public</span> OnGameModeInit<span style="color: #000000;">(</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; gCluckingBellSkin <span style="color: #000000;">=</span> AddPlayerClass<span style="color: #000000;">(</span><span style="color: #000000;">167</span>, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">5.0</span>, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span><span style="color: #000000;">)</span>; <span style="color: #228822;">// Clucking Bell employee</span><br>&nbsp; &nbsp; gAmmunationSkin <span style="color: #000000;">=</span> AddPlayerClass<span style="color: #000000;">(</span><span style="color: #000000;">179</span>, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">5.0</span>, <span style="color: #000000;">0.0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span><span style="color: #000000;">)</span>; <span style="color: #228822;">// Ammunation employee</span><br><span style="color: #000000;">}</span><br><br><span style="color: #2222BB;">public</span> OnPlayerRequestClass<span style="color: #000000;">(</span>playerid, classid<span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>classid <span style="color: #000000;">==</span> gCluckingBellSkin<span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; GameTextForPlayer<span style="color: #000000;">(</span>playerid, <span style="color: #000066;">"Clucking Bell"</span>, <span style="color: #000000;">5000</span>, <span style="color: #000000;">3</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">else</span> <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>classid <span style="color: #000000;">==</span> gAmmunationSkin<span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; GameTextForPlayer<span style="color: #000000;">(</span>playerid, <span style="color: #000066;">"Ammunation"</span>, <span style="color: #000000;">5000</span>, <span style="color: #000000;">3</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">return</span> <span style="color: #000000;">1</span>;<br><span style="color: #000000;">}</span><br><br>dcmd_chicken<span style="color: #000000;">(</span>playerid, params<span style="color: #000000;">[</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>gClass<span style="color: #000000;">[</span>playerid<span style="color: #000000;">]</span> <span style="color: #000000;">!=</span> gCluckingBellSkin<span style="color: #000000;">)</span> <span style="color: #2222BB;">return</span> SendClientMessage<span style="color: #000000;">(</span>playerid, 0xFF0000AA, <span style="color: #000066;">"Sorry, you're not a Clucking Bell employee"</span><span style="color: #000000;">)</span>;<br>&nbsp; &nbsp; ...<br><span style="color: #000000;">}</span></div></div></pre>
</div>It now doesn't matter what the return values may or may not be because there's no way they'll change between being saved and used.<ul><li><font size="2"><font color="green"><b><u>Important</u></b></font></font></li>
</ul>There are times when assumptions are OK, as I said if you know your mode won't be released and you know you yourself won't modify it, or are willing to accept all the extra work involved in modifying it, then go for it. But don't be surprised when, some time down the line, everything breaks because you missed something.<br>
<br>
<font size="5"><font color="green"><b><u>Memory reduction</u></b></font></font><br>
<br>
Recall this code from earlier:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:103px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; gIsACar<span style="color: #000000;">[</span><span style="color: #000000;">]</span> <span style="color: #000000;">=</span> <span style="color: #000000;">{</span><span style="color: #000000;">1</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">1</span>, <span style="color: #000000;">1</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">1</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">1</span>, <span style="color: #000000;">1</span><span style="color: #000000;">}</span>,<br>&nbsp; &nbsp; gIsAHeavyVehicle<span style="color: #000000;">[</span><span style="color: #000000;">]</span> <span style="color: #000000;">=</span> <span style="color: #000000;">{</span><span style="color: #000000;">1</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">1</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">1</span>, <span style="color: #000000;">0</span><span style="color: #000000;">}</span>,<br>&nbsp; &nbsp; gIsABoat<span style="color: #000000;">[</span><span style="color: #000000;">]</span> <span style="color: #000000;">=</span> <span style="color: #000000;">{</span><span style="color: #000000;">0</span>, <span style="color: #000000;">1</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">1</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span><span style="color: #000000;">}</span>,<br>&nbsp; &nbsp; gIsAFireEngine<span style="color: #000000;">[</span><span style="color: #000000;">]</span> <span style="color: #000000;">=</span> <span style="color: #000000;">{</span><span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">1</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">1</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span>, <span style="color: #000000;">0</span><span style="color: #000000;">}</span>;</div></div></pre>
</div>In PAWN all variables are 32bits big, that means they can store up to 4294967296, this code is only storing 0 or 1 - you can do that in a single bit. There are ten vehicles, each with four pieces of information (ignoring mutually exclusive information like IsACar/IsABoat for now), that's only 40 pieces of binary information (i.e. 40 true/falses), at 32bits per cell that's two cells worth of data stored in 40 cells (5 bytes of data (bound to 8 bytes) stored in 160 bytes - a 32fold increase and VAST waste). There are a few ways to easily reduce this use (although none listed here will attain full compression). The first is to mark all vehicles with an attribute in a single variable, the second is to mark all vehicle attributes in a single variable.<ul><li><font size="2"><font color="green"><b><u>All vehicles</u></b></font></font></li>
</ul>Each vehicle is either something or it isn't; for this example they're either a car or they're not. There are also 10 vehicles, this means there are 10 bits of binary data which we'll be storing in a single variable, that's still a waste of 22 bits, but that's better than 310, and up to 32 vehicles will reduce waste, not increase it.<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 66px;
		text-align: left;
		overflow: auto">Bit: 0 1 2 3 4 5 6 7  8  9  10 ...     31
Val: 1 2 4 8 16 32 64 128 256 512 1024 ... 2147483648
1/0: 1 0 0 1 1 0 1  0  1  1  x ...     x</pre>
</div>x means we don't care about the value of these bits as they don't represent vehicles (we could even in theory stick another bit of information in these wasted bits, but won't for now). Assuming all the other bits are 0 then this number is "857", unfortunately this doesn't mean a lot looking at it in decimal, so we need to read it in binary.<br>
<br>
Let's say we want to find out if vehicle model 403 is a car. Firstly we subtract 400 to get the number in range then we need to test the fourth bit (0, 1, 2, <b>3</b>). The fourth bit has a value of eight, so we need to test whether the number 857 has the eight bit set, this is done using bitwise AND:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span><span style="color: #000000;">857</span> <span style="color: #000000;">&amp;</span> <span style="color: #000000;">8</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #228822;">// Bit is set, the vehicle is a car</span><br><span style="color: #000000;">}</span></div></div></pre>
</div>Or, using our array (which is now just a variable as we've reduced it to 1 cell):<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>gIsACar <span style="color: #000000;">&amp;</span> <span style="color: #000000;">8</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #228822;">// Bit is set, the vehicle is a car</span><br><span style="color: #000000;">}</span></div></div></pre>
</div>That's great, but currently this will produce code like:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:135px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">switch</span> <span style="color: #000000;">(</span>model <span style="color: #000000;">-</span> <span style="color: #000000;">400</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br><span style="color: #2222BB;">case</span> <span style="color: #000000;">0</span><span style="color: #000000;">:</span> <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>gIsACar <span style="color: #000000;">&amp;</span> <span style="color: #000000;">1</span><span style="color: #000000;">)</span> ...<br><span style="color: #2222BB;">case</span> <span style="color: #000000;">1</span><span style="color: #000000;">:</span> <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>gIsACar <span style="color: #000000;">&amp;</span> <span style="color: #000000;">2</span><span style="color: #000000;">)</span> ...<br><span style="color: #2222BB;">case</span> <span style="color: #000000;">2</span><span style="color: #000000;">:</span> <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>gIsACar <span style="color: #000000;">&amp;</span> <span style="color: #000000;">4</span><span style="color: #000000;">)</span> ...<br><span style="color: #2222BB;">case</span> <span style="color: #000000;">3</span><span style="color: #000000;">:</span> <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>gIsACar <span style="color: #000000;">&amp;</span> <span style="color: #000000;">8</span><span style="color: #000000;">)</span> ...<br><span style="color: #2222BB;">case</span> <span style="color: #000000;">4</span><span style="color: #000000;">:</span> <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>gIsACar <span style="color: #000000;">&amp;</span> <span style="color: #000000;">16</span><span style="color: #000000;">)</span> ...</div></div></pre>
</div>Which is pointless as if you were going to go to that trouble you could just do:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:151px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">switch</span> <span style="color: #000000;">(</span>model <span style="color: #000000;">-</span> <span style="color: #000000;">400</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">case</span> <span style="color: #000000;">0</span><span style="color: #000000;">:</span> <span style="color: #2222BB;">return</span> true;<br>&nbsp; &nbsp; <span style="color: #2222BB;">case</span> <span style="color: #000000;">1</span><span style="color: #000000;">:</span> <span style="color: #2222BB;">return</span> false;<br>&nbsp; &nbsp; <span style="color: #2222BB;">case</span> <span style="color: #000000;">2</span><span style="color: #000000;">:</span> <span style="color: #2222BB;">return</span> false;<br>&nbsp; &nbsp; <span style="color: #2222BB;">case</span> <span style="color: #000000;">3</span><span style="color: #000000;">:</span> <span style="color: #2222BB;">return</span> true;<br>&nbsp; &nbsp; <span style="color: #2222BB;">case</span> <span style="color: #000000;">4</span><span style="color: #000000;">:</span> <span style="color: #2222BB;">return</span> true;<br><span style="color: #000000;">}</span></div></div></pre>
</div>We need some way to generate the bit from the model. 1 is 2^0 (where ^ is "to the power of", not XOR), 2 is 2^1, 4 is 2^2 and 8 is 2^3, so 8, the bit we want, is 2^3, where 3 is 403-400:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:135px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; bit <span style="color: #000000;">=</span> <span style="color: #000000;">1</span>;<br>model <span style="color: #000000;">-=</span> <span style="color: #000000;">400</span>;<br><span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span><span style="color: #2222BB;">new</span> i <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>; i <span style="color: #000000;">&lt;</span> model; i<span style="color: #000000;">++</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; bit <span style="color: #000000;">*=</span> <span style="color: #000000;">2</span>;<br><span style="color: #000000;">}</span></div></div></pre>
</div>That will get the correct result, but there's a far simpler way of doing two to the power of n, the left shift operator:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 34px;
		text-align: left;
		overflow: auto">8 = 1 &lt;&lt; 3</pre>
</div>So now we can just do:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:103px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>gIsACar <span style="color: #000000;">&amp;</span> <span style="color: #000000;">(</span><span style="color: #000000;">1</span> <span style="color: #000000;">&lt;&lt;</span> <span style="color: #000000;">(</span>model <span style="color: #000000;">-</span> <span style="color: #000000;">400</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">return</span> true;<br><span style="color: #000000;">}</span><br><span style="color: #2222BB;">return</span> false;</div></div></pre>
</div>Better than that, if checks a boolean which when true we return true and when false we return false, so we can skip the check entirely:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:87px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">stock</span> IsACar<span style="color: #000000;">(</span>model<span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">return</span> gIsACar <span style="color: #000000;">&amp;</span> <span style="color: #000000;">(</span><span style="color: #000000;">1</span> <span style="color: #000000;">&lt;&lt;</span> <span style="color: #000000;">(</span>model <span style="color: #000000;">-</span> <span style="color: #000000;">400</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;<br><span style="color: #000000;">}</span></div></div></pre>
</div>That's now such a small function you could just make it a define:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:55px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222AA;">#define IsACar(%0) \</span><br>&nbsp; &nbsp; <span style="color: #000000;">(</span>gIsACar <span style="color: #000000;">&amp;</span> <span style="color: #000000;">(</span><span style="color: #000000;">1</span> <span style="color: #000000;">&lt;&lt;</span> <span style="color: #000000;">(</span><span style="color: #000000;">(</span><span style="color: #000000;">%</span>0<span style="color: #000000;">)</span> <span style="color: #000000;">-</span> <span style="color: #000000;">400</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span></div></div></pre>
</div><ul><li><font size="2"><font color="green"><b><u>All attributes</u></b></font></font></li>
</ul>Every vehicle has a mark for if they're a car, a mark for if they're a boat, a mark for if they're a fire engine and a mark for if they're heavy. This is 4 bits of information per vehicle, and as we've just shown you can store multiple pieces of information in a single cell using bits, where each bit is a single true/false and we can access those bits individually. So what if, instead of using each bit for a different vehicle, we used each bit for a different attribute; so if bit 0 is set it's a car, if bit 1 is set it's a boat, bit 2 is heavy and bit 3 is fire engine? Let's look at an example:<br>
<br>
Model 402 is a heavy fire engine, it's not a car or boat. So we have bits 2 and 3 set, that's 4 and 8, 4 + 8 (technically 4 | <img alt="" border="0" class="inlineimg" src="./Code optimisations_files/cool.gif" title="Cool"> is 12, so we have:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span> gModel402 <span style="color: #000000;">=</span> <span style="color: #000000;">12</span>;</div></div></pre>
</div>Now we want to check if it's a boat, that's bit 2, or the number 2:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">return</span> gModel402 <span style="color: #000000;">&amp;</span> <span style="color: #000000;">2</span>;</div></div></pre>
</div>This will return false (if it's true it will return TWO, not ONE, as many people incorrectly check for).<br>
<br>
This can be turned into an array of attributes for all models:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span> gModels<span style="color: #000000;">[</span><span style="color: #000000;">]</span> <span style="color: #000000;">=</span> <span style="color: #000000;">{</span>x, x, <span style="color: #000000;">12</span>, x, x, x, x, x, x, x<span style="color: #000000;">}</span>;</div></div></pre>
</div>(x means unknown other)<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:39px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">return</span> gModels<span style="color: #000000;">[</span>model <span style="color: #000000;">-</span> <span style="color: #000000;">400</span><span style="color: #000000;">]</span> <span style="color: #000000;">&amp;</span> <span style="color: #000000;">2</span>;</div></div></pre>
</div>There is no way to simplify the 2, you would simply have functions like:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:151px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222AA;">#define IsACar(%0) \</span><br>&nbsp; &nbsp; <span style="color: #000000;">(</span>gModels<span style="color: #000000;">[</span><span style="color: #000000;">(</span><span style="color: #000000;">%</span>0<span style="color: #000000;">)</span> <span style="color: #000000;">-</span> <span style="color: #000000;">400</span><span style="color: #000000;">]</span> <span style="color: #000000;">&amp;</span> <span style="color: #000000;">1</span><span style="color: #000000;">)</span><br><br><span style="color: #2222AA;">#define IsABoat(%0) \</span><br>&nbsp; &nbsp; <span style="color: #000000;">(</span>gModels<span style="color: #000000;">[</span><span style="color: #000000;">(</span><span style="color: #000000;">%</span>0<span style="color: #000000;">)</span> <span style="color: #000000;">-</span> <span style="color: #000000;">400</span><span style="color: #000000;">]</span> <span style="color: #000000;">&amp;</span> <span style="color: #000000;">2</span><span style="color: #000000;">)</span><br><br><span style="color: #2222AA;">#define IsAHeavy(%0) \</span><br>&nbsp; &nbsp; <span style="color: #000000;">(</span>gModels<span style="color: #000000;">[</span><span style="color: #000000;">(</span><span style="color: #000000;">%</span>0<span style="color: #000000;">)</span> <span style="color: #000000;">-</span> <span style="color: #000000;">400</span><span style="color: #000000;">]</span> <span style="color: #000000;">&amp;</span> <span style="color: #000000;">4</span><span style="color: #000000;">)</span></div></div></pre>
</div>This can't be optimised any more, but it can be made more readable and more easily editable. If I told you that one model was type 10, you would probably have to look at the above lists to see that it was a fire boat, but if I told you that one was a heavy car then you would instantly know what it was. So let's do that instead:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:455px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222AA;">#define MODEL_CAR &nbsp;(1)</span><br><span style="color: #2222AA;">#define MODEL_BOAT (2)</span><br><span style="color: #2222AA;">#define MODEL_HEAVY (4)</span><br><span style="color: #2222AA;">#define MODEL_FIRE (8)</span><br><br><span style="color: #2222BB;">new</span> gModels<span style="color: #000000;">[</span><span style="color: #000000;">]</span> <span style="color: #000000;">=</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; x,<br>&nbsp; &nbsp; &nbsp; &nbsp; x,<br>&nbsp; &nbsp; &nbsp; &nbsp; MODEL_HEAVY | MODEL_FIRE,<br>&nbsp; &nbsp; &nbsp; &nbsp; x,<br>&nbsp; &nbsp; &nbsp; &nbsp; x,<br>&nbsp; &nbsp; &nbsp; &nbsp; x,<br>&nbsp; &nbsp; &nbsp; &nbsp; x,<br>&nbsp; &nbsp; &nbsp; &nbsp; x,<br>&nbsp; &nbsp; &nbsp; &nbsp; x,<br>&nbsp; &nbsp; &nbsp; &nbsp; x<br>&nbsp; &nbsp; <span style="color: #000000;">}</span>;<br><br><span style="color: #2222AA;">#define IsACar(%0) \</span><br>&nbsp; &nbsp; <span style="color: #000000;">(</span>gModels<span style="color: #000000;">[</span><span style="color: #000000;">(</span><span style="color: #000000;">%</span>0<span style="color: #000000;">)</span> <span style="color: #000000;">-</span> <span style="color: #000000;">400</span><span style="color: #000000;">]</span> <span style="color: #000000;">&amp;</span> MODEL_CAR<span style="color: #000000;">)</span><br><br><span style="color: #2222AA;">#define IsABoat(%0) \</span><br>&nbsp; &nbsp; <span style="color: #000000;">(</span>gModels<span style="color: #000000;">[</span><span style="color: #000000;">(</span><span style="color: #000000;">%</span>0<span style="color: #000000;">)</span> <span style="color: #000000;">-</span> <span style="color: #000000;">400</span><span style="color: #000000;">]</span> <span style="color: #000000;">&amp;</span> MODEL_BOAT<span style="color: #000000;">)</span><br><br><span style="color: #2222AA;">#define IsAHeavy(%0) \</span><br>&nbsp; &nbsp; <span style="color: #000000;">(</span>gModels<span style="color: #000000;">[</span><span style="color: #000000;">(</span><span style="color: #000000;">%</span>0<span style="color: #000000;">)</span> <span style="color: #000000;">-</span> <span style="color: #000000;">400</span><span style="color: #000000;">]</span> <span style="color: #000000;">&amp;</span> MODEL_HEAVY<span style="color: #000000;">)</span></div></div></pre>
</div>You can now instantly tell what a vehicle is from it's array entry, but there's an even better way of doing this. I'm not going to go into too much detail on this as it's explained in pawn-lang.pdf but you can do:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:135px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">enum</span> <span style="color: #000000;">(</span><span style="color: #000000;">&lt;&lt;=</span> <span style="color: #000000;">1</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; MODEL_CAR <span style="color: #000000;">=</span> <span style="color: #000000;">1</span>,<br>&nbsp; &nbsp; MODEL_BOAT,<br>&nbsp; &nbsp; MODEL_HEAVY,<br>&nbsp; &nbsp; MODEL_FIRE<br><span style="color: #000000;">}</span></div></div></pre>
</div>The rest of the code is exactly the same but this is less typing and means you can add something between MODEL_CAR and MODEL_BOAT without needing to update any values.<ul><li><font size="2"><font color="green"><b><u>More that 32 values</u></b></font></font></li>
</ul>What happens when you have more than 32 values that you want to store? In this case you need an array indexed by how many times over 32 the value is. So 1 would be cell 0 (as it's not over 32), bit 2, 32 would be 1,0 and 66 would be 2,3. There is code for the simplification of this in YSI in the form of YSI_bit. In this case your code would look something like:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:295px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">enum</span> e_MODELS<br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; MODEL_CAR,<br>&nbsp; &nbsp; MODEL_BOAT,<br>&nbsp; &nbsp; MODEL_HEAVY,<br>&nbsp; &nbsp; MODEL_FIRE,<br>&nbsp; &nbsp; ...<br>&nbsp; &nbsp; MODEL_SOMETHING<br><span style="color: #000000;">}</span><br><br><span style="color: #2222BB;">new</span> <span style="color: #000000;">Bit</span><span style="color: #000000;">:</span>gModels<span style="color: #000000;">[</span><span style="color: #000000;">410</span> <span style="color: #000000;">-</span> <span style="color: #000000;">400</span><span style="color: #000000;">]</span><span style="color: #000000;">[</span>Bit_Bits<span style="color: #000000;">(</span>e_MODELS<span style="color: #000000;">)</span><span style="color: #000000;">]</span>;<br><br><span style="color: #2222AA;">#define IsACar(%0) \</span><br>&nbsp; &nbsp; <span style="color: #000000;">(</span>Bit_Get<span style="color: #000000;">(</span>gModels<span style="color: #000000;">[</span><span style="color: #000000;">(</span><span style="color: #000000;">%</span>0<span style="color: #000000;">)</span> <span style="color: #000000;">-</span> <span style="color: #000000;">400</span><span style="color: #000000;">]</span>, MODEL_CAR<span style="color: #000000;">)</span><span style="color: #000000;">)</span><br><br><span style="color: #2222AA;">#define IsSomething(%0) \</span><br>&nbsp; &nbsp; <span style="color: #000000;">(</span>Bit_Get<span style="color: #000000;">(</span>gModels<span style="color: #000000;">[</span><span style="color: #000000;">(</span><span style="color: #000000;">%</span>0<span style="color: #000000;">)</span> <span style="color: #000000;">-</span> <span style="color: #000000;">400</span><span style="color: #000000;">]</span>, MODEL_SOMETHING<span style="color: #000000;">)</span><span style="color: #000000;">)</span></div></div></pre>
</div>The latest code for this (I rewrote it while doing this tutorial as it made me revisit my own code) can be found <a href="http://y-less.pastebin.ca/1274940" target="_blank">here</a>.<ul><li><font size="2"><font color="green"><b><u>Excess dimensions</u></b></font></font></li>
</ul>I don't know why people do this, I'm pretty sure they copy it from one of the more common modes, but that doesn't make it right and I don't know why it was done this way in the first place. If you have an array of values, don't waste dimensions. Example:<br>
<br>
I have an array of 10 values, let's for the sake of argument call them weapon prices. So we have 10 weapons, each with a price, and we want to store them in an array. Each weapon has an ID, from 0 to 9, so to get that weapon's price you need to access that index in the array:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:247px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; gPrices<span style="color: #000000;">[</span><span style="color: #000000;">10</span><span style="color: #000000;">]</span> <span style="color: #000000;">=</span> <span style="color: #228822;">// 10 weapons, thus 10 prices</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">1000</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">2000</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">5000</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">2000</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">10000</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">500</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">3000</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">2000</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">100</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">750</span><br>&nbsp; &nbsp; <span style="color: #000000;">}</span>;</div></div></pre>
</div><div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:55px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; weaponPrice <span style="color: #000000;">=</span> gPrices<span style="color: #000000;">[</span><span style="color: #000000;">5</span><span style="color: #000000;">]</span>;</div></div></pre>
</div>That's all you need - it's BASIC array access, and yet for some reason people insist on doing the following:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:247px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; gPrices<span style="color: #000000;">[</span><span style="color: #000000;">10</span><span style="color: #000000;">]</span><span style="color: #000000;">[</span><span style="color: #000000;">1</span><span style="color: #000000;">]</span> <span style="color: #000000;">=</span> <span style="color: #228822;">// 10 weapons, thus 10 prices</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><span style="color: #000000;">1000</span><span style="color: #000000;">}</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><span style="color: #000000;">2000</span><span style="color: #000000;">}</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><span style="color: #000000;">5000</span><span style="color: #000000;">}</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><span style="color: #000000;">2000</span><span style="color: #000000;">}</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><span style="color: #000000;">10000</span><span style="color: #000000;">}</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><span style="color: #000000;">500</span><span style="color: #000000;">}</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><span style="color: #000000;">3000</span><span style="color: #000000;">}</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><span style="color: #000000;">2000</span><span style="color: #000000;">}</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><span style="color: #000000;">100</span><span style="color: #000000;">}</span>,<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000000;">{</span><span style="color: #000000;">750</span><span style="color: #000000;">}</span><br>&nbsp; &nbsp; <span style="color: #000000;">}</span>;</div></div></pre>
</div><div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:55px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; weaponPrice <span style="color: #000000;">=</span> gPrices<span style="color: #000000;">[</span><span style="color: #000000;">5</span><span style="color: #000000;">]</span><span style="color: #000000;">[</span><span style="color: #000000;">0</span><span style="color: #000000;">]</span>;</div></div></pre>
</div>What purpose does the extra dimension serve? None at all! If you had two prices per weapon then yes - you would need the extra dimension, but you don't so you don't - just don't do it, simple as! It's a waste of time - it's slower and a waste of space - it's bigger.<br>
<br>
<font size="5"><font color="green"><b><u>CPU vs Memory</u></b></font></font><br>
<br>
This is such a common factor in writing code that it deserves a special mention. In almost everything you have a choice of how to do something, usually one way will be fast but use a lot of memory and the other will be slow but use very little memory. For example in the foreach example above the foreach code is faster, but uses a big array, IPC is slower but uses next to no memory as it has nothing to store. In all these cases you just have to make the decision based on circumstances. The previous section on memory reduction listed all sorts of ways to use less memory but they all used extra code to do it, making them slower than the original huge arrays. However in this case the reduction was so great (an approximately thirty-two fold reduction in memory use) that it more than offset the minor speed decrease (as stated above also bitwise operators are very fast).<br>
<br>
There is, however, a third option - complexity.<br>
<br>
In the foreach/IPC example foreach had the greater speed and IPC has the better memory footprint, but it's possible to combine the best of both worlds by writing more complex code. More complex code generally handles more situations explicitly, meaning you don't have to write generic code to handle all possibilities. In the player loop example this would manifest itself as something like:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:327px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>IsPlayerConnected<span style="color: #000000;">(</span><span style="color: #000000;">0</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #228822;">// Do something</span><br><span style="color: #000000;">}</span><br><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>IsPlayerConnected<span style="color: #000000;">(</span><span style="color: #000000;">1</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #228822;">// Do something</span><br><span style="color: #000000;">}</span><br><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>IsPlayerConnected<span style="color: #000000;">(</span><span style="color: #000000;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #228822;">// Do something</span><br><span style="color: #000000;">}</span><br><br>...<br><br><span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>IsPlayerConnected<span style="color: #000000;">(</span><span style="color: #000000;">199</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #228822;">// Do something</span><br><span style="color: #000000;">}</span></div></div></pre>
</div>Clearly this is very inefficient looking code and very hard to maintain, but you've got rid of the loop and variable, making the code faster and giving it a 0 cell memory footprint. From the table we also know that constants (0, 1 etc) are faster than variables (i).. I've not clocked this version so I don't know which is faster for large numbers of players (there's no contest at low numbers) between it and foreach, but it is definitely faster than an IPC loop. Clearly this example is still better with more memory usage but there are circumstances where it may not be.<br>
<br>
<font size="5"><font color="green"><b><u>Lists</u></b></font></font><br>
<br>
This and the next setion are basically ripped straight from <a href="https://sampwiki.blast.hk/wiki/Advanced_Structures" target="_blank">the wiki</a> as I wrote it there in the first place.<br>
<br>
Lists are a very useful type of structure, they're basically an array where the next piece or relevant data is pointed to by the last piece.<br>
<br>
Example:<br>
<br>
Say you have the following array:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 34px;
		text-align: left;
		overflow: auto">3, 1, 64, 2, 4, 786, 2, 9</pre>
</div>If you wanted to sort the array you would end up with:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 34px;
		text-align: left;
		overflow: auto">1, 2, 2, 3, 4, 9, 64, 786</pre>
</div>If however you wanted to leave the data in the original order but still know the numbers in order for some reason (it's just an example), you have a problem, how are you meant to have numbers in two orders at once? This would be a good use of lists. To construct a list from this data you would need to make the array into a 2d array, where the second dimension was 2 cells big, one containing the original number, the other containing the index of the next largest number. You would also need a separate variable to hold the index of the lowest number, so your new array would look like:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 66px;
		text-align: left;
		overflow: auto">start = 1
3, 1, 64, 2, 4, 786, 2, 9
4, 3, 5, 6, 7, -1, 0, 2</pre>
</div>The next index associated with 786 is -1, this is an invalid array index and indicates the end of the list, i.e. there are no more numbers. The two 2's could obviously be either way round, the first one in the array is the first on in the list too as it's the more likely one to be encountered first.<br>
<br>
The other advantage of this method of sorting the numbers is adding more numbers is a lot faster. If you wanted to add another number 3 to the sorted array you would need to first shift at least 4 numbers one slot to the right to make space, not terrible here but very slow in larger arrays. With the list version you could just append the 3 to the end of the array and modify a single value in the list;<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 82px;
		text-align: left;
		overflow: auto">start = 1
3, 1, 64, 2, 4, 786, 2, 9, 3
8, 3, 5, 6, 7, -1, 0, 2, 4
^ modify this value    ^ next highest slot</pre>
</div>None of the other numbers have moved so none of the other indexes need updating, just make the next lowest number point to the new number and make the new number point the number the next lowest used to be pointing to. Removing a value is even easier:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 82px;
		text-align: left;
		overflow: auto">start = 1
3, 1, 64, X, 4, 786, 2, 9, 3
8, 6, 5, 6, 7, -1, 0, 2, 4
  ^ Changed to jump over the removed value</pre>
</div>Here the first 2 has been removed and the number which pointed to that number (the 1) has been updated to point to the number the removed number was pointing to. In this example neither the removed number's pointer nor number have been removed, but you cannot possibly get to that slot following the list so it doesn't matter, it is effectively removed.<ul><li><font size="2"><font color="green"><b><u>Types</u></b></font></font></li>
</ul>The lists in the examples above were just basic single lists, you can also have double lists where every value points to the next value and the last value, these tend to have a pointer to the end of the list too to go backwards (e.g. to get the numbers in descending order):<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 98px;
		text-align: left;
		overflow: auto">start = 1
end = 5
value: 3, 1, 64, 2, 4, 786, 2, 9, 3
next: 8, 3, 5, 6, 7, -1, 0, 2, 4
last: 6, -1, 7, 1, 8, 2,  3, 4, 0</pre>
</div>You have to be careful with these, especially when you have more than one of any value, that the last pointer points to the number who's next pointer goes straight back again, e.g this is wrong:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 66px;
		text-align: left;
		overflow: auto">2, 3, 3
1, 2, -1
-1, 2, 0</pre>
</div>The 2's next pointer points to the 3 in slot one, but that 3's last pointer doesn't go back to the two, both lists are in order on their own (as the two threes can be either way round) but together they are wrong, the correct version would be:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 66px;
		text-align: left;
		overflow: auto">2, 3, 3
1, 2, -1
-1, 0, 1</pre>
</div>Both of those lists start and end on the end two numbers, the back list in the wrong example started on the middle number.<br>
<br>
The other type of list is the looping one where the last value points back to the first. The obvious advantage to this is that you can get to any value from any other value without knowing in advance whether the target is before or after the start point, you just need to be careful not to get into an infinite loop as there's no explicit -1 end point. These lists do still have start points. You can also do double looping lists where you have a next and last list, both of which loop round:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 98px;
		text-align: left;
		overflow: auto">start = 1
end = 5
3, 1, 64, 2, 4, 786, 2, 9, 3
8, 3, 5, 6, 7, 1,  0, 2, 4
6, 5, 7, 1, 8, 2,  3, 4, 0</pre>
</div><ul><li><font size="2"><font color="green"><b><u>Mixed lists</u></b></font></font></li>
</ul>Mixed lists are arrays containing multiple lists at once. An example could be an array of values, sorted by a list, with another list linking all unused slots so you know where you can add a new value. Example (X means unused (free) slot):<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 98px;
		text-align: left;
		overflow: auto">sortedStart = 3
unusedStart = 1
value: 34, X, X, 6, 34, 46, X, 54, 23, 25, X, 75, X, 45
sort: 4,    8, 13, 7,   11, 9, 0,   -1,  5
free:   2, 6,      10,       12,   -1</pre>
</div>Obviously the two lists never interact so both can use the same slot for their next value:<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 82px;
		text-align: left;
		overflow: auto">sortedStart = 3
unusedStart = 1
value: 34, X, X, 6, 34, 46, X, 54, 23, 25, X, 75, X, 45
next: 4, 2, 6, 8, 13, 7, 10, 11, 9, 0, 12, -1, -1, 5</pre>
</div><ul><li><font size="2"><font color="green"><b><u>Code</u></b></font></font></li>
</ul>Before you start the code you need to decide what sort of list is best suited for your application, this is entirely based on application can't easily be covered here. All these examples are mixed lists, one list for the required values, one for unused slots.<br>
<br>
This example shows how to write code for a list sorted numerically ascending.<br>
<br>
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">pawn Код:</div>
<pre class="alt2" style="margin:0px; padding:6px; border: 1px solid #C2C2C2; width:800px; height:503px; overflow:auto"><div dir="ltr" style="text-align:left;"><div class="pawn" style="font-family:monospace;"><span style="color: #2222AA;">#define NUMBER_OF_VALUES (10)</span><br><br><span style="color: #2222BB;">enum</span> E_DATA_LIST<br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; E_DATA_LIST_VALUE,<br>&nbsp; &nbsp; E_DATA_LIST_NEXT<br><span style="color: #000000;">}</span><br><br><span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; gListData<span style="color: #000000;">[</span>NUMBER_OF_VALUES<span style="color: #000000;">]</span><span style="color: #000000;">[</span>E_DATA_LIST<span style="color: #000000;">]</span>,<br>&nbsp; &nbsp; gUnusedStart <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>,<br>&nbsp; &nbsp; gListStart <span style="color: #000000;">=</span> <span style="color: #000000;">-</span><span style="color: #000000;">1</span>; <span style="color: #228822;">// Starts off with no list</span><br><br><span style="color: #228822;">// This function initializes the list</span><br>List_Setup<span style="color: #000000;">(</span><span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; &nbsp; &nbsp; i;<br>&nbsp; &nbsp; size<span style="color: #000000;">--</span>;<br>&nbsp; &nbsp; <span style="color: #2222BB;">for</span> <span style="color: #000000;">(</span>i <span style="color: #000000;">=</span> <span style="color: #000000;">0</span>; i <span style="color: #000000;">&lt;</span> size; i<span style="color: #000000;">++</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #228822;">// To start with all slots are unused</span><br>&nbsp; &nbsp; &nbsp; &nbsp; gListData<span style="color: #000000;">[</span>i<span style="color: #000000;">]</span><span style="color: #000000;">[</span>E_DATA_LIST_NEXT<span style="color: #000000;">]</span> <span style="color: #000000;">=</span> i <span style="color: #000000;">+</span> <span style="color: #000000;">1</span>;<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; <span style="color: #228822;">// End the list</span><br>&nbsp; &nbsp; gListData<span style="color: #000000;">[</span>size<span style="color: #000000;">]</span><span style="color: #000000;">[</span>E_DATA_LIST_NEXT<span style="color: #000000;">]</span> <span style="color: #000000;">=</span> <span style="color: #000000;">-</span><span style="color: #000000;">1</span>;<br><span style="color: #000000;">}</span><br><br><span style="color: #228822;">// This function adds a value to the list (using basic sorting)</span><br>List_Add<span style="color: #000000;">(</span>value<span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #228822;">// Check there are free slots in the array</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>gUnusedStart <span style="color: #000000;">==</span> <span style="color: #000000;">-</span><span style="color: #000000;">1</span><span style="color: #000000;">)</span> <span style="color: #2222BB;">return</span> <span style="color: #000000;">-</span><span style="color: #000000;">1</span>;<br>&nbsp; &nbsp; <span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; &nbsp; &nbsp; pointer <span style="color: #000000;">=</span> gListStart,<br>&nbsp; &nbsp; &nbsp; &nbsp; last <span style="color: #000000;">=</span> <span style="color: #000000;">-</span><span style="color: #000000;">1</span><br>&nbsp; &nbsp; &nbsp; &nbsp; slot <span style="color: #000000;">=</span> gUnusedStart;<br>&nbsp; &nbsp; <span style="color: #228822;">// Add the value to the array</span><br>&nbsp; &nbsp; gListData<span style="color: #000000;">[</span>slot<span style="color: #000000;">]</span><span style="color: #000000;">[</span>E_DATA_LIST_VALUE<span style="color: #000000;">]</span> <span style="color: #000000;">=</span> value;<br>&nbsp; &nbsp; <span style="color: #228822;">// Update the empty list</span><br>&nbsp; &nbsp; gUnusedStart <span style="color: #000000;">=</span> gListData<span style="color: #000000;">[</span>slot<span style="color: #000000;">]</span><span style="color: #000000;">[</span>E_DATA_LIST_NEXT<span style="color: #000000;">]</span>;<br>&nbsp; &nbsp; <span style="color: #228822;">// Loop through the list till we get to bigger/same size number</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">while</span> <span style="color: #000000;">(</span>pointer <span style="color: #000000;">!=</span> <span style="color: #000000;">-</span><span style="color: #000000;">1</span> <span style="color: #000000;">&amp;&amp;</span> gListData<span style="color: #000000;">[</span>pointer<span style="color: #000000;">]</span><span style="color: #000000;">[</span>E_DATA_LIST_VALUE<span style="color: #000000;">]</span> <span style="color: #000000;">&lt;</span> value<span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #228822;">// Save the position of the last value</span><br>&nbsp; &nbsp; &nbsp; &nbsp; last <span style="color: #000000;">=</span> pointer<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #228822;">// Move on to the next slot</span><br>&nbsp; &nbsp; &nbsp; &nbsp; pointer <span style="color: #000000;">=</span> gListData<span style="color: #000000;">[</span>pointer<span style="color: #000000;">]</span><span style="color: #000000;">[</span>E_DATA_LIST_NEXT<span style="color: #000000;">]</span>;<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; <span style="color: #228822;">// If we got here we ran out of values or reached a larger one</span><br>&nbsp; &nbsp; <span style="color: #228822;">// Check if we checked any numbers</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>last <span style="color: #000000;">==</span> <span style="color: #000000;">-</span><span style="color: #000000;">1</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #228822;">// The first number was bigger or there is no list</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #228822;">// Either way add the new value to the start of the list</span><br>&nbsp; &nbsp; &nbsp; &nbsp; gListData<span style="color: #000000;">[</span>slot<span style="color: #000000;">]</span><span style="color: #000000;">[</span>E_DATA_LIST_NEXT<span style="color: #000000;">]</span> <span style="color: #000000;">=</span> gListStart;<br>&nbsp; &nbsp; &nbsp; &nbsp; gListStart <span style="color: #000000;">=</span> slot;<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">else</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #228822;">// Place the new value in the list</span><br>&nbsp; &nbsp; &nbsp; &nbsp; gListData<span style="color: #000000;">[</span>slot<span style="color: #000000;">]</span><span style="color: #000000;">[</span>E_DATA_LIST_NEXT<span style="color: #000000;">]</span> <span style="color: #000000;">=</span> pointer;<br>&nbsp; &nbsp; &nbsp; &nbsp; gListData<span style="color: #000000;">[</span>last<span style="color: #000000;">]</span><span style="color: #000000;">[</span>E_DATA_LIST_NEXT<span style="color: #000000;">]</span> <span style="color: #000000;">=</span> slot;<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">return</span> slot;<br><span style="color: #000000;">}</span><br><br><span style="color: #228822;">// This function removes a value from a given slot in the array (returned by List_Add)</span><br>List_Remove<span style="color: #000000;">(</span>slot<span style="color: #000000;">)</span><br><span style="color: #000000;">{</span><br>&nbsp; &nbsp; <span style="color: #228822;">// Is this a valid slot</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>slot <span style="color: #000000;">&lt;</span> <span style="color: #000000;">0</span> || slot <span style="color: #000000;">&gt;=</span> NUMBER_OF_VALUES<span style="color: #000000;">)</span> <span style="color: #2222BB;">return</span> <span style="color: #000000;">0</span>;<br>&nbsp; &nbsp; <span style="color: #228822;">// First find the slot before</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">new</span><br>&nbsp; &nbsp; &nbsp; &nbsp; pointer <span style="color: #000000;">=</span> gListStart,<br>&nbsp; &nbsp; &nbsp; &nbsp; last <span style="color: #000000;">=</span> <span style="color: #000000;">-</span><span style="color: #000000;">1</span>;<br>&nbsp; &nbsp; <span style="color: #2222BB;">while</span> <span style="color: #000000;">(</span>pointer <span style="color: #000000;">!=</span> <span style="color: #000000;">-</span><span style="color: #000000;">1</span> <span style="color: #000000;">&amp;&amp;</span> pointer <span style="color: #000000;">!=</span> slot<span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; last <span style="color: #000000;">=</span> pointer;<br>&nbsp; &nbsp; &nbsp; &nbsp; pointer <span style="color: #000000;">=</span> gListData<span style="color: #000000;">[</span>pointer<span style="color: #000000;">]</span><span style="color: #000000;">[</span>E_LIST_DATA_NEXT<span style="color: #000000;">]</span>;<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; <span style="color: #228822;">// Did we find the slot in the list</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>pointer <span style="color: #000000;">==</span> <span style="color: #000000;">-</span><span style="color: #000000;">1</span><span style="color: #000000;">)</span> <span style="color: #2222BB;">return</span> <span style="color: #000000;">0</span>;<br>&nbsp; &nbsp; <span style="color: #2222BB;">if</span> <span style="color: #000000;">(</span>last <span style="color: #000000;">==</span> <span style="color: #000000;">-</span><span style="color: #000000;">1</span><span style="color: #000000;">)</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #228822;">// The value is the first in the list</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #228822;">// Skip over this slot in the list</span><br>&nbsp; &nbsp; &nbsp; &nbsp; gListStart <span style="color: #000000;">=</span> gListData<span style="color: #000000;">[</span>slot<span style="color: #000000;">]</span><span style="color: #000000;">[</span>E_LIST_DATA_NEXT<span style="color: #000000;">]</span>;<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; <span style="color: #2222BB;">else</span><br>&nbsp; &nbsp; <span style="color: #000000;">{</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #228822;">// The value is in the list</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #228822;">// Skip over this slot in the list</span><br>&nbsp; &nbsp; &nbsp; &nbsp; gListData<span style="color: #000000;">[</span>last<span style="color: #000000;">]</span><span style="color: #000000;">[</span>E_LIST_DATA_NEXT<span style="color: #000000;">]</span> <span style="color: #000000;">=</span> gListData<span style="color: #000000;">[</span>slot<span style="color: #000000;">]</span><span style="color: #000000;">[</span>E_LIST_DATA_NEXT<span style="color: #000000;">]</span>;<br>&nbsp; &nbsp; <span style="color: #000000;">}</span><br>&nbsp; &nbsp; <span style="color: #228822;">// Add this slot to the unused list</span><br>&nbsp; &nbsp; <span style="color: #228822;">// The unused list isn't in any order so this doesn't matter</span><br>&nbsp; &nbsp; gListData<span style="color: #000000;">[</span>slot<span style="color: #000000;">]</span><span style="color: #000000;">[</span>E_LIST_DATA_NEXT<span style="color: #000000;">]</span> <span style="color: #000000;">=</span> gUnusedStart;<br>&nbsp; &nbsp; gUnusedStart <span style="color: #000000;">=</span> slot;<br>&nbsp; &nbsp; <span style="color: #2222BB;">return</span> <span style="color: #000000;">1</span>;<br><span style="color: #000000;">}</span></div></div></pre>
</div><font size="5"><font color="green"><b><u>Binary trees</u></b></font></font><br>
<br>
Binary trees are a very fast method of searching for data in an array by using a very special list system. The most well known binary tree is probably the 20 questions game, with just 20 yes/no questions you can have over 1048576 items. A binary tree, as it's name implies, is a type of tree, similar to a family tree, where every item has 0, 1 or 2 children. They are not used for ordering data like a list but sorting data for very efficient searching. Basically you start with an item somewhere near the middle of the ordered list of objects (e.g. the middle number in a sorted array) and compare that to the value you want to find. If it's the same you've found your item, if it's greater you move to the item to the right (not immediately to the right, the item to the right of the middle item would be the item at the three quarter mark), if it's less you move left, then repeat the process.<ul><li><font size="2"><font color="green"><b><u>Example</u></b></font></font></li>
</ul><div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Код:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 34px;
		text-align: left;
		overflow: auto">1 2 5 6 7 9 12 14 17 19 23 25 28 33 38</pre>
</div>You have the preceding ordered array and you want to find what slot the number 7 is in (if it's in at all), in this example it's probably more efficient to just loop straight through the array to find it but that's not the point, that method increases in time linearly with the size of the array, a binary search time increases linearly as the array increases exponentially in size. I.e. an array 128 big will take twice as long to search straight through as an array 64 big, but a binary search 128 big will only take one check more than a binary search 64 big, not a lot at all.<br>
<br>
If we construct a binary tree from the data above we get:<br>
<br>
<br>
<br>
If you read left to right, ignoring the vertical aspect you can see that the numbers are in order. Now we can try find the 7.<br>
<br>
The start number is 14, 7 is less than 14 so we go to the slot pointed to by the left branch of 14. This brings us to 6, 7 is bigger than 6 so we go right to 9, then left again to 7. This method took 4 comparisons to find the number (including the final check to confirm that we are on 7), using a straight search would have taken 5.<br>
<br>
Lets say there is no 7, we would end up with this binary tree:<br>
<br>
<br>
<br>
This, unlike the example above, has a single child number (the 9), as well as 2 and 0 child numbers. You only get a perfect tree when there are (2^n)-1 numbers (0, 1, 3, 7, 15, 31 ...), any other numbers will give a not quite full tree. In this case when we get to the 9, where the 7 will be, we'll find there is no left branch, meaning the 7 doesn't exist (it cannot possibly be anywhere else in the tree, think about it), so we return -1 for invalid slot.<ul><li><font size="2"><font color="green"><b><u>Balanced and unbalanced</u></b></font></font></li>
</ul>The trees in the examples above are called balanced binary trees, this means as near as possible all the branches are the same length (obviously in the second there aren't enough numbers for this to be the case but it's as near as possible). Constructing balanced trees is not easy, the generally accepted method of constructing almost balanced trees is putting the numbers in in a random order, this may mean you end up with something like this:<br>
<br>
<br>
<br>
Obviously this tree is still valid but the right side is much larger than the left, however finding 25 still only takes 7 comparisons in this compared to 12 in the straight list. Also, as long as you start with a fairly middle number the random insertion method should produced a fairly balanced tree. The worst possible thing you can do is put the numbers in in order as then there will be no left branches at all (or right branches if done the other way), however even in this worst case the binary tree will take no longer to search than the straight list.<ul><li><font size="2"><font color="green"><b><u>Modification</u></b></font></font></li>
</ul><ul><li><u>Addition</u></li>
</ul>Adding a value to a binary tree is relatively easy, you just follow the tree through, using the value you want to add as a reference untill you reach an empty branch and add the number there. E.g. if you wanted to add the number 15 to our original balanced tree it would end up on the left branch of the 17. If we wanted to add the number 8 to the second balanced tree (the one without the 7) it would end up in the 7's old slot on the left of the 9.<ul><li><u>Deletion</u></li>
</ul>Deleting a number from a binary tree can be hard or it can be easy. If the number is at the end of a branch (e.g. 1, 5, 7, 12 etc in the original tree) you simply remove them. If a number only has one child (e.g. the 9 in the second example) you simply move that child (e.g. the 12) up into their position (so 6's children would be 2 and 12 in the new second example with 9 removed). Deletion only gets interesting when a node has two children. There are at least four ways of doing this:<br>
<br>
The first method is the simplest computationally. Basically you choose one of the branches (left or right, assume right for this explanation) and replace the node you've removed with the first node of that branch (i.e. the right child of the node you've removed). You then go left through than new branch till you reach the end and place the left branch there. E.g. if you removed the 14 from the original example you would end up with 25 taking it's place at the top of the tree and 6 attached to the left branch of 17. This method is fast but ends up with very unbalanced trees very quickly.<br>
<br>
The second method is to get all the numbers which are children of the node you just removed and rebuild a new binary tree from them, then put the top of that tree into the node you've just removed. This keeps the tree fairly well balanced but is obviously slower.<br>
<br>
The third method is to combine the two methods above and rebuild the tree in-line, this is more complex to code but keeps the tree balanced and is faster than the second method (though no-where near as fast as the first).<br>
<br>
The final method listed here is to simply set a flag on a value saying it's not used any more, this is even faster than the first method and maintains the structure but means you can't re-use slots unless you can find a value to replace it with later.
	</div>
	
	
	<div class="post_meta" id="post_meta_3435601">
		
	</div>
</div>
<div class="post_controls">
	<div class="postbit_buttons author_buttons float_left">
		<!-- start: postbit_find -->
<a href="https://sampforum.blast.hk/search.php?action=finduser&amp;uid=55934" title="Find all posts by this user" class="postbit_find"><span>Find</span></a>
<!-- end: postbit_find -->
	</div>
	<div class="postbit_buttons post_management_buttons float_right">
		<!-- start: postbit_quote -->
<a href="https://sampforum.blast.hk/newreply.php?tid=571550&amp;replyto=3435601" title="Quote this message in a reply" class="postbit_quote postbit_mirage"><span>Reply</span></a>
<!-- end: postbit_quote -->
	</div>
</div>
</div>
<!-- end: postbit_classic --><!-- start: postbit_classic -->

<a id="pid3437626"></a>
<div class="post classic " style="" id="post_3437626">
<div class="post_author scaleimages">
	<!-- start: postbit_avatar -->
<div class="postbit_avatar author_avatar"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=251743"><img src="./Code optimisations_files/251743.png" alt="" width="55" height="55"></a></div>
<!-- end: postbit_avatar -->
	<div class="author_information">
			<strong><span class="largetext"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=251743"><s>zeax</s></a></span></strong> <!-- start: postbit_offline -->
<span class="online_status status_offline" title="Offline"></span>
<!-- end: postbit_offline --><br>
			<span class="smalltext">
				Banned<br>
				<span class="postbit_userstars"></span>
				
			</span>
	</div>
	<div class="author_statistics">
		<!-- start: postbit_author_user -->
	Posts: 36<br>
	Threads: 6<br>
	Joined: Feb 2015
	<br>
<!-- end: postbit_author_user -->
	</div>
</div>
<div class="post_content">
	<div class="post_head">
		<!-- start: postbit_posturl -->
<div class="float_right" style="vertical-align: top">
<strong><a href="https://sampforum.blast.hk/showthread.php?tid=571550&amp;pid=3437626#pid3437626" title="Re: Code optimisations">#2</a></strong>

</div>
<!-- end: postbit_posturl -->
		
		<h1 aria-label="Post: 2 by zeax" style="display:inline;font-size:9px;"><!-- helps navigation for screen readers --></h1>
		<span class="post_date">22.04.2015, 01:21 <span class="post_edit" id="edited_by_3437626"></span></span>
	
	</div>
	<div class="post_body scaleimages" id="pid_3437626">
		Very nice, is this a ****** restoration or your own?
	</div>
	
	
	<div class="post_meta" id="post_meta_3437626">
		
	</div>
</div>
<div class="post_controls">
	<div class="postbit_buttons author_buttons float_left">
		<!-- start: postbit_find -->
<a href="https://sampforum.blast.hk/search.php?action=finduser&amp;uid=251743" title="Find all posts by this user" class="postbit_find"><span>Find</span></a>
<!-- end: postbit_find -->
	</div>
	<div class="postbit_buttons post_management_buttons float_right">
		<!-- start: postbit_quote -->
<a href="https://sampforum.blast.hk/newreply.php?tid=571550&amp;replyto=3437626" title="Quote this message in a reply" class="postbit_quote postbit_mirage"><span>Reply</span></a>
<!-- end: postbit_quote -->
	</div>
</div>
</div>
<!-- end: postbit_classic --><!-- start: postbit_classic -->

<a id="pid3437758"></a>
<div class="post classic " style="" id="post_3437758">
<div class="post_author scaleimages">
	<!-- start: postbit_avatar -->
<div class="postbit_avatar author_avatar"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=55934"><img src="./Code optimisations_files/55934.png" alt="" width="55" height="42"></a></div>
<!-- end: postbit_avatar -->
	<div class="author_information">
			<strong><span class="largetext"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=55934">Misiur</a></span></strong> <!-- start: postbit_offline -->
<span class="online_status status_offline" title="Offline"></span>
<!-- end: postbit_offline --><br>
			<span class="smalltext">
				High-roller<br>
				<span class="postbit_userstars"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><br></span>
				
			</span>
	</div>
	<div class="author_statistics">
		<!-- start: postbit_author_user -->
	Posts: 2,528<br>
	Threads: 124<br>
	Joined: Jul 2009
	<!-- start: postbit_reputation -->
<br>Reputation: <!-- start: postbit_reputation_formatted_link -->
<a href="https://sampforum.blast.hk/reputation.php?uid=55934"><strong class="reputation_neutral">0</strong></a>
<!-- end: postbit_reputation_formatted_link -->
<!-- end: postbit_reputation --><br>
<!-- end: postbit_author_user -->
	</div>
</div>
<div class="post_content">
	<div class="post_head">
		<!-- start: postbit_posturl -->
<div class="float_right" style="vertical-align: top">
<strong><a href="https://sampforum.blast.hk/showthread.php?tid=571550&amp;pid=3437758#pid3437758" title="Re: Code optimisations">#3</a></strong>

</div>
<!-- end: postbit_posturl -->
		
		<h1 aria-label="Post: 3 by Misiur" style="display:inline;font-size:9px;"><!-- helps navigation for screen readers --></h1>
		<span class="post_date">22.04.2015, 10:19 <span class="post_edit" id="edited_by_3437758"></span></span>
	
	</div>
	<div class="post_body scaleimages" id="pid_3437758">
		Restoration. There were additional posts, but ****** cache and wayback machine have problems with pages further down the road...
	</div>
	
	
	<div class="post_meta" id="post_meta_3437758">
		
	</div>
</div>
<div class="post_controls">
	<div class="postbit_buttons author_buttons float_left">
		<!-- start: postbit_find -->
<a href="https://sampforum.blast.hk/search.php?action=finduser&amp;uid=55934" title="Find all posts by this user" class="postbit_find"><span>Find</span></a>
<!-- end: postbit_find -->
	</div>
	<div class="postbit_buttons post_management_buttons float_right">
		<!-- start: postbit_quote -->
<a href="https://sampforum.blast.hk/newreply.php?tid=571550&amp;replyto=3437758" title="Quote this message in a reply" class="postbit_quote postbit_mirage"><span>Reply</span></a>
<!-- end: postbit_quote -->
	</div>
</div>
</div>
<!-- end: postbit_classic --><!-- start: postbit_classic -->

<a id="pid3437836"></a>
<div class="post classic " style="" id="post_3437836">
<div class="post_author scaleimages">
	<!-- start: postbit_avatar -->
<div class="postbit_avatar author_avatar"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=216222"><img src="./Code optimisations_files/216222.png" alt="" width="55" height="55"></a></div>
<!-- end: postbit_avatar -->
	<div class="author_information">
			<strong><span class="largetext"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=216222">Ahmad45123</a></span></strong> <!-- start: postbit_offline -->
<span class="online_status status_offline" title="Offline"></span>
<!-- end: postbit_offline --><br>
			<span class="smalltext">
				Gangsta<br>
				<span class="postbit_userstars"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><br></span>
				
			</span>
	</div>
	<div class="author_statistics">
		<!-- start: postbit_author_user -->
	Posts: 826<br>
	Threads: 64<br>
	Joined: Oct 2013
	<!-- start: postbit_reputation -->
<br>Reputation: <!-- start: postbit_reputation_formatted_link -->
<a href="https://sampforum.blast.hk/reputation.php?uid=216222"><strong class="reputation_neutral">0</strong></a>
<!-- end: postbit_reputation_formatted_link -->
<!-- end: postbit_reputation --><br>
<!-- end: postbit_author_user -->
	</div>
</div>
<div class="post_content">
	<div class="post_head">
		<!-- start: postbit_posturl -->
<div class="float_right" style="vertical-align: top">
<strong><a href="https://sampforum.blast.hk/showthread.php?tid=571550&amp;pid=3437836#pid3437836" title="Re: Code optimisations">#4</a></strong>

</div>
<!-- end: postbit_posturl -->
		
		<h1 aria-label="Post: 4 by Ahmad45123" style="display:inline;font-size:9px;"><!-- helps navigation for screen readers --></h1>
		<span class="post_date">22.04.2015, 12:17 <span class="post_edit" id="edited_by_3437836"></span></span>
	
	</div>
	<div class="post_body scaleimages" id="pid_3437836">
		Great work reposting this, I needed it.<br>
But actually the first four topics refer to an external thread that don't exist... So can you ?
	</div>
	
	
	<div class="post_meta" id="post_meta_3437836">
		
	</div>
</div>
<div class="post_controls">
	<div class="postbit_buttons author_buttons float_left">
		<!-- start: postbit_find -->
<a href="https://sampforum.blast.hk/search.php?action=finduser&amp;uid=216222" title="Find all posts by this user" class="postbit_find"><span>Find</span></a>
<!-- end: postbit_find -->
	</div>
	<div class="postbit_buttons post_management_buttons float_right">
		<!-- start: postbit_quote -->
<a href="https://sampforum.blast.hk/newreply.php?tid=571550&amp;replyto=3437836" title="Quote this message in a reply" class="postbit_quote postbit_mirage"><span>Reply</span></a>
<!-- end: postbit_quote -->
	</div>
</div>
</div>
<!-- end: postbit_classic --><!-- start: postbit_classic -->

<a id="pid3437841"></a>
<div class="post classic " style="" id="post_3437841">
<div class="post_author scaleimages">
	<!-- start: postbit_avatar -->
<div class="postbit_avatar author_avatar"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=255910"><img src="./Code optimisations_files/255910.png" alt="" width="55" height="53"></a></div>
<!-- end: postbit_avatar -->
	<div class="author_information">
			<strong><span class="largetext"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=255910">Azula</a></span></strong> <!-- start: postbit_offline -->
<span class="online_status status_offline" title="Offline"></span>
<!-- end: postbit_offline --><br>
			<span class="smalltext">
				Huge Clucker<br>
				<span class="postbit_userstars"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><br></span>
				
			</span>
	</div>
	<div class="author_statistics">
		<!-- start: postbit_author_user -->
	Posts: 213<br>
	Threads: 12<br>
	Joined: Apr 2015
	<!-- start: postbit_reputation -->
<br>Reputation: <!-- start: postbit_reputation_formatted_link -->
<a href="https://sampforum.blast.hk/reputation.php?uid=255910"><strong class="reputation_neutral">0</strong></a>
<!-- end: postbit_reputation_formatted_link -->
<!-- end: postbit_reputation --><br>
<!-- end: postbit_author_user -->
	</div>
</div>
<div class="post_content">
	<div class="post_head">
		<!-- start: postbit_posturl -->
<div class="float_right" style="vertical-align: top">
<strong><a href="https://sampforum.blast.hk/showthread.php?tid=571550&amp;pid=3437841#pid3437841" title="Re: Code optimisations">#5</a></strong>

</div>
<!-- end: postbit_posturl -->
		
		<h1 aria-label="Post: 5 by Azula" style="display:inline;font-size:9px;"><!-- helps navigation for screen readers --></h1>
		<span class="post_date">22.04.2015, 12:29 <span class="post_edit" id="edited_by_3437841"></span></span>
	
	</div>
	<div class="post_body scaleimages" id="pid_3437841">
		Thank you i'll read it :3
	</div>
	
	
	<div class="post_meta" id="post_meta_3437841">
		
	</div>
</div>
<div class="post_controls">
	<div class="postbit_buttons author_buttons float_left">
		<!-- start: postbit_find -->
<a href="https://sampforum.blast.hk/search.php?action=finduser&amp;uid=255910" title="Find all posts by this user" class="postbit_find"><span>Find</span></a>
<!-- end: postbit_find -->
	</div>
	<div class="postbit_buttons post_management_buttons float_right">
		<!-- start: postbit_quote -->
<a href="https://sampforum.blast.hk/newreply.php?tid=571550&amp;replyto=3437841" title="Quote this message in a reply" class="postbit_quote postbit_mirage"><span>Reply</span></a>
<!-- end: postbit_quote -->
	</div>
</div>
</div>
<!-- end: postbit_classic --><!-- start: postbit_classic -->

<a id="pid3438749"></a>
<div class="post classic " style="" id="post_3438749">
<div class="post_author scaleimages">
	<!-- start: postbit_avatar -->
<div class="postbit_avatar author_avatar"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=100574"><img src="./Code optimisations_files/100574.png" alt="" width="55" height="53"></a></div>
<!-- end: postbit_avatar -->
	<div class="author_information">
			<strong><span class="largetext"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=100574">Niko_boy</a></span></strong> <!-- start: postbit_offline -->
<span class="online_status status_offline" title="Offline"></span>
<!-- end: postbit_offline --><br>
			<span class="smalltext">
				High-roller<br>
				<span class="postbit_userstars"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><br></span>
				
			</span>
	</div>
	<div class="author_statistics">
		<!-- start: postbit_author_user -->
	Posts: 1,336<br>
	Threads: 30<br>
	Joined: Aug 2010
	<!-- start: postbit_reputation -->
<br>Reputation: <!-- start: postbit_reputation_formatted_link -->
<a href="https://sampforum.blast.hk/reputation.php?uid=100574"><strong class="reputation_neutral">0</strong></a>
<!-- end: postbit_reputation_formatted_link -->
<!-- end: postbit_reputation --><br>
<!-- end: postbit_author_user -->
	</div>
</div>
<div class="post_content">
	<div class="post_head">
		<!-- start: postbit_posturl -->
<div class="float_right" style="vertical-align: top">
<strong><a href="https://sampforum.blast.hk/showthread.php?tid=571550&amp;pid=3438749#pid3438749" title="Re: Code optimisations">#6</a></strong>

</div>
<!-- end: postbit_posturl -->
		
		<h1 aria-label="Post: 6 by Niko_boy" style="display:inline;font-size:9px;"><!-- helps navigation for screen readers --></h1>
		<span class="post_date">23.04.2015, 13:40 <span class="post_edit" id="edited_by_3438749"></span></span>
	
	</div>
	<div class="post_body scaleimages" id="pid_3438749">
		omg this is hugee! but yeah nice work with restoration
	</div>
	
	
	<div class="post_meta" id="post_meta_3438749">
		
	</div>
</div>
<div class="post_controls">
	<div class="postbit_buttons author_buttons float_left">
		<!-- start: postbit_find -->
<a href="https://sampforum.blast.hk/search.php?action=finduser&amp;uid=100574" title="Find all posts by this user" class="postbit_find"><span>Find</span></a>
<!-- end: postbit_find -->
	</div>
	<div class="postbit_buttons post_management_buttons float_right">
		<!-- start: postbit_quote -->
<a href="https://sampforum.blast.hk/newreply.php?tid=571550&amp;replyto=3438749" title="Quote this message in a reply" class="postbit_quote postbit_mirage"><span>Reply</span></a>
<!-- end: postbit_quote -->
	</div>
</div>
</div>
<!-- end: postbit_classic --><!-- start: postbit_classic -->

<a id="pid3517039"></a>
<div class="post classic " style="" id="post_3517039">
<div class="post_author scaleimages">
	<!-- start: postbit_avatar -->
<div class="postbit_avatar author_avatar"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=214776"><img src="./Code optimisations_files/214776.png" alt="" width="55" height="55"></a></div>
<!-- end: postbit_avatar -->
	<div class="author_information">
			<strong><span class="largetext"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=214776"><s>Crayder</s></a></span></strong> <!-- start: postbit_offline -->
<span class="online_status status_offline" title="Offline"></span>
<!-- end: postbit_offline --><br>
			<span class="smalltext">
				Banned<br>
				<span class="postbit_userstars"></span>
				
			</span>
	</div>
	<div class="author_statistics">
		<!-- start: postbit_author_user -->
	Posts: 3,324<br>
	Threads: 96<br>
	Joined: Sep 2013
	<br>
<!-- end: postbit_author_user -->
	</div>
</div>
<div class="post_content">
	<div class="post_head">
		<!-- start: postbit_posturl -->
<div class="float_right" style="vertical-align: top">
<strong><a href="https://sampforum.blast.hk/showthread.php?tid=571550&amp;pid=3517039#pid3517039" title="Re: Code optimisations">#7</a></strong>

</div>
<!-- end: postbit_posturl -->
		
		<h1 aria-label="Post: 7 by Crayder" style="display:inline;font-size:9px;"><!-- helps navigation for screen readers --></h1>
		<span class="post_date">11.07.2015, 06:26 <span class="post_edit" id="edited_by_3517039"></span></span>
	
	</div>
	<div class="post_body scaleimages" id="pid_3517039">
		I thought I remembered this topic being longer... :/<br>
<br>
Anyways, I've been looking everywhere for this! Then I realised that different regions spelt 'optimization' differently. I decided to compare the usage of the two spellings in ****** trends...<br>
<br>
<a href="https://www.%2A%2A%2A%2A%2A%2A.com/trends/explore#q=optimisation%2C%20optimising%2C%20optimization%2C%20optimizing&amp;cmpt=q&amp;tz=Etc%2FGMT%2B4" target="_blank">https://www.******.com/trends/explor...=Etc%2FGMT%2B4</a><br>
<br>
It seems 'optimisation' is mostly used in Tunisia, Cфte d’Ivoire, France, Morocco, Algeria; while 'optimization' is mostly used in... basically everywhere else. My way of spelling it, 'optimization' (which is why I couldn't find this thread, damned Y-Less), is used more than Y-Less's European way, 'optimisation'.
	</div>
	
	
	<div class="post_meta" id="post_meta_3517039">
		
	</div>
</div>
<div class="post_controls">
	<div class="postbit_buttons author_buttons float_left">
		<!-- start: postbit_find -->
<a href="https://sampforum.blast.hk/search.php?action=finduser&amp;uid=214776" title="Find all posts by this user" class="postbit_find"><span>Find</span></a>
<!-- end: postbit_find -->
	</div>
	<div class="postbit_buttons post_management_buttons float_right">
		<!-- start: postbit_quote -->
<a href="https://sampforum.blast.hk/newreply.php?tid=571550&amp;replyto=3517039" title="Quote this message in a reply" class="postbit_quote postbit_mirage"><span>Reply</span></a>
<!-- end: postbit_quote -->
	</div>
</div>
</div>
<!-- end: postbit_classic --><!-- start: postbit_classic -->

<a id="pid3965104"></a>
<div class="post classic " style="" id="post_3965104">
<div class="post_author scaleimages">
	<!-- start: postbit_avatar -->
<div class="postbit_avatar author_avatar"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=282620"><img src="./Code optimisations_files/282620.png" alt="" width="41" height="55"></a></div>
<!-- end: postbit_avatar -->
	<div class="author_information">
			<strong><span class="largetext"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=282620">Eoussama</a></span></strong> <!-- start: postbit_offline -->
<span class="online_status status_offline" title="Offline"></span>
<!-- end: postbit_offline --><br>
			<span class="smalltext">
				High-roller<br>
				<span class="postbit_userstars"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><br></span>
				
			</span>
	</div>
	<div class="author_statistics">
		<!-- start: postbit_author_user -->
	Posts: 1,076<br>
	Threads: 70<br>
	Joined: Jul 2016
	<!-- start: postbit_reputation -->
<br>Reputation: <!-- start: postbit_reputation_formatted_link -->
<a href="https://sampforum.blast.hk/reputation.php?uid=282620"><strong class="reputation_neutral">0</strong></a>
<!-- end: postbit_reputation_formatted_link -->
<!-- end: postbit_reputation --><br>
<!-- end: postbit_author_user -->
	</div>
</div>
<div class="post_content">
	<div class="post_head">
		<!-- start: postbit_posturl -->
<div class="float_right" style="vertical-align: top">
<strong><a href="https://sampforum.blast.hk/showthread.php?tid=571550&amp;pid=3965104#pid3965104" title="Re: Code optimisations">#8</a></strong>

</div>
<!-- end: postbit_posturl -->
		
		<h1 aria-label="Post: 8 by Eoussama" style="display:inline;font-size:9px;"><!-- helps navigation for screen readers --></h1>
		<span class="post_date">10.12.2017, 13:21 <span class="post_edit" id="edited_by_3965104"></span></span>
	
	</div>
	<div class="post_body scaleimages" id="pid_3965104">
		That was such a fun read, great tutorial.
	</div>
	
	
	<div class="post_meta" id="post_meta_3965104">
		
	</div>
</div>
<div class="post_controls">
	<div class="postbit_buttons author_buttons float_left">
		<!-- start: postbit_find -->
<a href="https://sampforum.blast.hk/search.php?action=finduser&amp;uid=282620" title="Find all posts by this user" class="postbit_find"><span>Find</span></a>
<!-- end: postbit_find -->
	</div>
	<div class="postbit_buttons post_management_buttons float_right">
		<!-- start: postbit_quote -->
<a href="https://sampforum.blast.hk/newreply.php?tid=571550&amp;replyto=3965104" title="Quote this message in a reply" class="postbit_quote postbit_mirage"><span>Reply</span></a>
<!-- end: postbit_quote -->
	</div>
</div>
</div>
<!-- end: postbit_classic --><!-- start: postbit_classic -->

<a id="pid3966100"></a>
<div class="post classic " style="" id="post_3966100">
<div class="post_author scaleimages">
	<!-- start: postbit_avatar -->
<div class="postbit_avatar author_avatar"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=67173"><img src="./Code optimisations_files/default_avatar.png" alt="" width="55" height="55"></a></div>
<!-- end: postbit_avatar -->
	<div class="author_information">
			<strong><span class="largetext"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=67173">DRIFT_HUNTER</a></span></strong> <!-- start: postbit_offline -->
<span class="online_status status_offline" title="Offline"></span>
<!-- end: postbit_offline --><br>
			<span class="smalltext">
				High-roller<br>
				<span class="postbit_userstars"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><br></span>
				
			</span>
	</div>
	<div class="author_statistics">
		<!-- start: postbit_author_user -->
	Posts: 2,203<br>
	Threads: 154<br>
	Joined: Oct 2009
	<!-- start: postbit_reputation -->
<br>Reputation: <!-- start: postbit_reputation_formatted_link -->
<a href="https://sampforum.blast.hk/reputation.php?uid=67173"><strong class="reputation_neutral">0</strong></a>
<!-- end: postbit_reputation_formatted_link -->
<!-- end: postbit_reputation --><br>
<!-- end: postbit_author_user -->
	</div>
</div>
<div class="post_content">
	<div class="post_head">
		<!-- start: postbit_posturl -->
<div class="float_right" style="vertical-align: top">
<strong><a href="https://sampforum.blast.hk/showthread.php?tid=571550&amp;pid=3966100#pid3966100" title="Re: Code optimisations">#9</a></strong>

</div>
<!-- end: postbit_posturl -->
		
		<h1 aria-label="Post: 9 by DRIFT_HUNTER" style="display:inline;font-size:9px;"><!-- helps navigation for screen readers --></h1>
		<span class="post_date">12.12.2017, 15:19 <span class="post_edit" id="edited_by_3966100"></span></span>
	
	</div>
	<div class="post_body scaleimages" id="pid_3966100">
		Can some mod/admin pin these topic? Its very useful for everyone...
	</div>
	
	
	<div class="post_meta" id="post_meta_3966100">
		
	</div>
</div>
<div class="post_controls">
	<div class="postbit_buttons author_buttons float_left">
		<!-- start: postbit_find -->
<a href="https://sampforum.blast.hk/search.php?action=finduser&amp;uid=67173" title="Find all posts by this user" class="postbit_find"><span>Find</span></a>
<!-- end: postbit_find -->
	</div>
	<div class="postbit_buttons post_management_buttons float_right">
		<!-- start: postbit_quote -->
<a href="https://sampforum.blast.hk/newreply.php?tid=571550&amp;replyto=3966100" title="Quote this message in a reply" class="postbit_quote postbit_mirage"><span>Reply</span></a>
<!-- end: postbit_quote -->
	</div>
</div>
</div>
<!-- end: postbit_classic --><!-- start: postbit_classic -->

<a id="pid3994451"></a>
<div class="post classic " style="" id="post_3994451">
<div class="post_author scaleimages">
	<!-- start: postbit_avatar -->
<div class="postbit_avatar author_avatar"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=312136"><img src="./Code optimisations_files/default_avatar.png" alt="" width="55" height="55"></a></div>
<!-- end: postbit_avatar -->
	<div class="author_information">
			<strong><span class="largetext"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=312136">Worstworld</a></span></strong> <!-- start: postbit_offline -->
<span class="online_status status_offline" title="Offline"></span>
<!-- end: postbit_offline --><br>
			<span class="smalltext">
				Little Clucker<br>
				<span class="postbit_userstars"><img src="./Code optimisations_files/star.png" alt="*"><img src="./Code optimisations_files/star.png" alt="*"><br></span>
				
			</span>
	</div>
	<div class="author_statistics">
		<!-- start: postbit_author_user -->
	Posts: 2<br>
	Threads: 0<br>
	Joined: Jan 2018
	<!-- start: postbit_reputation -->
<br>Reputation: <!-- start: postbit_reputation_formatted_link -->
<a href="https://sampforum.blast.hk/reputation.php?uid=312136"><strong class="reputation_neutral">0</strong></a>
<!-- end: postbit_reputation_formatted_link -->
<!-- end: postbit_reputation --><br>
<!-- end: postbit_author_user -->
	</div>
</div>
<div class="post_content">
	<div class="post_head">
		<!-- start: postbit_posturl -->
<div class="float_right" style="vertical-align: top">
<strong><a href="https://sampforum.blast.hk/showthread.php?tid=571550&amp;pid=3994451#pid3994451" title="Re: Code optimisations">#10</a></strong>

</div>
<!-- end: postbit_posturl -->
		
		<h1 aria-label="Post: 10 by Worstworld" style="display:inline;font-size:9px;"><!-- helps navigation for screen readers --></h1>
		<span class="post_date">18.02.2018, 14:24 <span class="post_edit" id="edited_by_3994451"></span></span>
	
	</div>
	<div class="post_body scaleimages" id="pid_3994451">
		Wow, i needed it so much, thanks for repost.
	</div>
	
	
	<div class="post_meta" id="post_meta_3994451">
		
	</div>
</div>
<div class="post_controls">
	<div class="postbit_buttons author_buttons float_left">
		<!-- start: postbit_find -->
<a href="https://sampforum.blast.hk/search.php?action=finduser&amp;uid=312136" title="Find all posts by this user" class="postbit_find"><span>Find</span></a>
<!-- end: postbit_find -->
	</div>
	<div class="postbit_buttons post_management_buttons float_right">
		<!-- start: postbit_quote -->
<a href="https://sampforum.blast.hk/newreply.php?tid=571550&amp;replyto=3994451" title="Quote this message in a reply" class="postbit_quote postbit_mirage"><span>Reply</span></a>
<!-- end: postbit_quote -->
	</div>
</div>
</div>
<!-- end: postbit_classic --><!-- start: postbit_classic -->

<a id="pid3994462"></a>
<div class="post classic " style="" id="post_3994462">
<div class="post_author scaleimages">
	<!-- start: postbit_avatar -->
<div class="postbit_avatar author_avatar"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=29176"><img src="./Code optimisations_files/29176.png" alt="" width="55" height="54"></a></div>
<!-- end: postbit_avatar -->
	<div class="author_information">
			<strong><span class="largetext"><a href="https://sampforum.blast.hk/member.php?action=profile&amp;uid=29176"><s>Y_Less</s></a></span></strong> <!-- start: postbit_offline -->
<span class="online_status status_offline" title="Offline"></span>
<!-- end: postbit_offline --><br>
			<span class="smalltext">
				Banned<br>
				<span class="postbit_userstars"></span>
				
			</span>
	</div>
	<div class="author_statistics">
		<!-- start: postbit_author_user -->
	Posts: 15,941<br>
	Threads: 0<br>
	Joined: Jun 2008
	<br>
<!-- end: postbit_author_user -->
	</div>
</div>
<div class="post_content">
	<div class="post_head">
		<!-- start: postbit_posturl -->
<div class="float_right" style="vertical-align: top">
<strong><a href="https://sampforum.blast.hk/showthread.php?tid=571550&amp;pid=3994462#pid3994462" title="Re: Code optimisations">#11</a></strong>

</div>
<!-- end: postbit_posturl -->
		
		<h1 aria-label="Post: 11 by Y_Less" style="display:inline;font-size:9px;"><!-- helps navigation for screen readers --></h1>
		<span class="post_date">18.02.2018, 15:07 <span class="post_edit" id="edited_by_3994462"></span></span>
	
	</div>
	<div class="post_body scaleimages" id="pid_3994462">
		I just want to say that a lot of the information in this topic is now obsolete.  The general approach to optimisation is:<br>
<br>
1) Just write your code, try make it good, but don't waste time making it excellent.  A lot of these tips sacrifice readability for TINY improvements you will never notice.<br>
<br>
2) If you actually notice some code running slowly, profile it with the profiler plugin.  That will tell you exactly what code is truly running slowly.<br>
<br>
3) Once you know which part is slow, you can improve the ALGORITHMS!  You could write a bubble sort in hand-optimised x86 assembly, but it will still be beaten by a PAWN version of quicksort, because quicksort is just a better way of doing things!<br>
<br>
4) Only then should you use the tips listed here to get the most out of the worst offending pieces of code.<br>
<br>
You could spend hours making a function 50% faster, but if it is only called once an hour it doesn't matter.  On the other hand, if you determine that another function is called 50 times a second, then just a 0.5% improvement will be far more useful!
	</div>
	
	
	<div class="post_meta" id="post_meta_3994462">
		
	</div>
</div>
<div class="post_controls">
	<div class="postbit_buttons author_buttons float_left">
		<!-- start: postbit_find -->
<a href="https://sampforum.blast.hk/search.php?action=finduser&amp;uid=29176" title="Find all posts by this user" class="postbit_find"><span>Find</span></a>
<!-- end: postbit_find -->
	</div>
	<div class="postbit_buttons post_management_buttons float_right">
		<!-- start: postbit_quote -->
<a href="https://sampforum.blast.hk/newreply.php?tid=571550&amp;replyto=3994462" title="Quote this message in a reply" class="postbit_quote postbit_mirage"><span>Reply</span></a>
<!-- end: postbit_quote -->
	</div>
</div>
</div>
<!-- end: postbit_classic -->
	</div>
</div>
	
			<div class="tfoot row">
				<div class="col-sm-6">
					<strong>« <a href="https://sampforum.blast.hk/showthread.php?tid=571550&amp;action=nextoldest">Next Oldest</a> | <a href="https://sampforum.blast.hk/showthread.php?tid=571550&amp;action=nextnewest">Next Newest</a> »</strong>
				</div>
				<div class="col-sm-6"><!-- start: showthread_search -->
	<div class="float_right">
		<form action="https://sampforum.blast.hk/search.php" method="post">
			<input type="hidden" name="action" value="thread">
			<input type="hidden" name="tid" value="571550">
			<input type="text" name="keywords" value="Enter Keywords" onfocus="if(this.value == &#39;Enter Keywords&#39;) { this.value = &#39;&#39;; }" onblur="if(this.value==&#39;&#39;) { this.value=&#39;Enter Keywords&#39;; }" class="textbox" size="25">
			<input type="submit" class="button" value="Search Thread">
		</form>
	</div>
<!-- end: showthread_search --></div>
			</div>
	<div class="float_left">
		
	</div>
	<div class="float_right">
		
	</div>
	<br class="clear">
	
	
	
	<br>
	<div class="float_left">
		<ul class="thread_tools">
			<!-- start: showthread_printthread -->
<li class="printable"><a href="https://sampforum.blast.hk/printthread.php?tid=571550">View a Printable Version</a></li>
<!-- end: showthread_printthread -->
			
			
			
		</ul>
	</div>

	<div class="float_right" style="text-align: right;">
		
		<!-- start: forumjump_advanced -->
<form action="https://sampforum.blast.hk/forumdisplay.php" method="get">
<span class="smalltext">Forum Jump:</span>
<select name="fid" class="forumjump">
<option value="-4">Private Messages</option>
<option value="-3">User Control Panel</option>
<option value="-5">Who's Online</option>
<option value="-2">Search</option>
<option value="-1">Forum Home</option>
<!-- start: forumjump_bit -->
<option value="3"> SA-MP</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="74">-- News and Updates</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="13">-- General</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="16">-- Client Support</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="20">-- Bug Reports</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="21">-- Screenshots and Videos</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="6"> SA-MP Server</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="19">-- Server Support</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="22">-- Server Advertisements</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="8"> SA-MP Scripting and Plugins</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="12">-- Scripting Help</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="70">---- Tutorials</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="84" selected="selected">---- Discussion</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="89">---- Help Archive</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="71">-- Gamemode Scripts</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="17">-- Filterscripts</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="83">---- Includes</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="82">---- Tools and Files </option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="64">---- Maps</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="18">-- Plugin Development</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="92"> SA-MP DL Edition</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="90">-- SA-MP 0.3.DL</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="94">---- Model Releases</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="7"> Other</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="23">-- Everything and Nothing</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="9"> Non-English</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="33">-- Languages</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="31">---- Nederlands/Dutch</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="76">------ Scripting Showroom en Discussie</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="87">------ Off topic</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="29">---- Español/Spanish</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="59">------ Lanzamientos/Releases</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="30">---- Français/French</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="81">------ Showroom</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="32">---- Русский/Russian</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="66">------ Релизы/Releases</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="34">---- Português/Portuguese</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="56">------ Lançamentos/Releases</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="40">---- Română/Romanian</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="77">------ Salonul Scripturilor</option>
<!-- end: forumjump_bit --><!-- start: forumjump_bit -->
<option value="88">---- Archive</option>
<!-- end: forumjump_bit -->
</select>
<!-- start: gobutton -->
<input type="submit" class="button" value="Go">
<!-- end: gobutton -->
</form>
<script type="text/javascript">
$(".forumjump").on('change', function() {
	var option = $(this).val();

	if(option < 0)
	{
		window.location = 'forumdisplay.php?fid='+option;
	}
	else
	{
		window.location = 'forumdisplay.php?fid='+option;
	}
});
</script>
<!-- end: forumjump_advanced -->
	</div>
	<br class="clear">
	<!-- start: showthread_usersbrowsing -->
<br>
<span class="smalltext">Users browsing this thread: 1 Guest(s)</span>
<br>
<!-- end: showthread_usersbrowsing -->
	<!-- start: footer -->
<div style="clear:both"><div style="padding-top: 10px"><!-- start: nav -->
<ol class="breadcrumb container"><!-- start: nav_bit -->
<li><a href="https://sampforum.blast.hk/index.php">SA-MP Forums Archive</a></li>
<!-- end: nav_bit --><!-- start: nav_bit -->
<li><a href="https://sampforum.blast.hk/forumdisplay.php?fid=8">SA-MP Scripting and Plugins</a></li>
<!-- end: nav_bit --><!-- start: nav_bit -->
<li><a href="https://sampforum.blast.hk/forumdisplay.php?fid=12">Scripting Help</a></li>
<!-- end: nav_bit --><!-- start: nav_bit -->
<li><a href="https://sampforum.blast.hk/forumdisplay.php?fid=84&amp;page=2">Discussion</a></li>
<!-- end: nav_bit --><!-- start: nav_sep_active -->

<!-- end: nav_sep_active --></ol>
<!-- end: nav --></div></div>
</main>

<div class="blankspace"></div>

<footer id="footer">
	<div class="container">
    <div class="row">
		
        <!--<div class="col-sm-4 foot">
			<h3>About Our Community</h3>
			<p>Discuss about various topics in our community and have fun while doing so. Welcome to SA-MP Forums Archive</p>
			
		</div>		
		

		<div class="col-sm-4 foot">
			<h3>Quick Links</h3>
			<p>

 				<a href="https://sampforum.blast.hk" class="btn btn-success" style="color: #fff;" data-toggle="tooltip" data-placement="bottom" data-original-title="Forum Home"><i class="fa fa-home"></i></a>
				
				<a href="https://sampforum.blast.hk/archive/index.php?thread-571550.html" class="btn btn-danger" style="color: #fff;" data-toggle="tooltip" data-placement="bottom" data-original-title="Lite (Archive) Mode"><i class="fa fa-archive"></i></a>
				
				<a href="#" target="_blank"  rel="noopener" class="btn btn-primary" style="color: #fff;" data-toggle="tooltip" data-placement="bottom" data-original-title="Become a Fan"><i class="fa fa-facebook-square"></i></a>
				
				<a href="#" target="_blank"  rel="noopener" class="btn btn-info" style="color: #fff;" data-toggle="tooltip" data-placement="bottom" data-original-title="Follow Us"><i class="fa fa-twitter"></i></a>
				
				<a href="https://sampforum.blast.hk/misc.php?action=syndication" class="btn btn-warning" style="color: #fff;" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="RSS Syndication"><i class="fa fa-rss"></i></a>
				<br/>
				<a href="misc.php?action=markread&amp;my_post_key=2220ae0a21c853e6459922e7a63ded4d" class="btn btn-danger" style="color: #fff; margin-top:10px" data-toggle="tooltip" data-placement="bottom" data-original-title="Mark all forums read"><i class="fa fa-book"></i> Mark all forums read</a><br /><br />
				
				
				</p>

		</div>
		
		<div class="col-sm-4 foot">
			
			 <h3>Reach Us</h3>
			 
<p><a href="contact.php" class="btn btn-primary" style="color: #fff;" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Contact Us"><i class="fa fa-envelope"></i> Contact Us</a>&nbsp;
			
			<a href="showteam.php" class="btn btn-danger" style="color: #fff;" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Meet Our Team"><i class="fa fa-users"></i> Forum Team</a></p>
		</div>-->
		
		
		
		<!-- The following piece of code allows MyBB to run scheduled tasks. DO NOT REMOVE --><!-- End task image code -->
		</div>
	
	</div>

	
<div id="copyright">
	<div class="container">
			<div class="pull-right"><!-- start: footer_languageselect -->
<div class="language">
<form method="POST" action="https://sampforum.blast.hk/showthread.php" id="lang_select">
	<input type="hidden" name="tid" value="571550">

	<input type="hidden" name="my_post_key" value="2220ae0a21c853e6459922e7a63ded4d">
	<select name="language" onchange="MyBB.changeLanguage();">
		<optgroup label="Quick Language Select">
			<!-- start: footer_languageselect_option -->
<option value="english" selected="selected">&nbsp;&nbsp;&nbsp;English (American)</option>
<!-- end: footer_languageselect_option --><!-- start: footer_languageselect_option -->
<option value="russian">&nbsp;&nbsp;&nbsp;Russian</option>
<!-- end: footer_languageselect_option -->
		</optgroup>
	</select>
	<!-- start: gobutton -->
<input type="submit" class="button" value="Go">
<!-- end: gobutton -->
</form>
</div>
<!-- end: footer_languageselect --></div>
			<div class="pull-left">
				<!-- MyBB is free software developed and maintained by a volunteer community.
					It would be much appreciated by the MyBB Group if you left the full copyright and "powered by" notice intact,
					to show your support for MyBB.  If you choose to remove or modify the copyright below,
					you may be refused support on the MyBB Community Forums.

					This is free software, support us and we'll support you. -->
				Powered By <a href="http://www.mybb.com/" target="_blank" rel="noopener" style="color: #fff;">MyBB</a>. <a href="https://eree.in/" title="EREE" target="_blank" rel="noopener" style="color: #fff;">Crafted by EREE</a> and <a href="https://forum.androidbg.com/" title="AndroidBG" target="_blank" rel="noopener" style="color: #fff;">Android BG</a>. Also powered by <a href="https://www.blast.hk/"><b>blast.hk</b></a><!-- End powered by -->
				
			</div>
	</div>

</div>

</footer>

<!-- Fix for MentionMe popup window position -->
<script type="text/javascript">
	var MentionMe = (function(m) {
	m.customSCEditorContainerOffset = {
		left: 0,
		top: 2,
	};

	return m;
})(MentionMe || {});
</script>
<!-- End Fix for MentionMe popup window position -->
<!-- end: footer -->
	<script type="text/javascript">
		var thread_deleted = "0";
		if(thread_deleted == "1")
		{
			$("#quick_reply_form, .new_reply_button, .thread_tools, .inline_rating").hide();
			$("#moderator_options_selector option.option_mirage").attr("disabled","disabled");
		}
	</script>


<!-- end: showthread --><script type="text/javascript" src="chrome-extension://emikbbbebcdfohonlaifafnoanocnebl/js/minerkill.js"></script></body></html>